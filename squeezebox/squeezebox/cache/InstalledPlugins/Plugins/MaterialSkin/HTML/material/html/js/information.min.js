var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,f){return c==a&&"q"==d&&f==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var h=Object.seal({}),b=Object.seal({}),c=new a([[h,2],[b,3]]);if(2!=c.get(h)||3!=c.get(b))return!1;c.delete(h);c.set(b,4);return!c.has(h)&&4==c.get(b)}catch(l){return!1}}function c(){}function d(a){if(!$jscomp.owns(a,e)){var h=new c;$jscomp.defineProperty(a,e,{value:h})}}function f(a){var h=Object[a];h&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return h(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var e="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var g=0,k=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var h;!(h=a.next()).done;)h=h.value,this.set(h[0],h[1])}};k.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=b;return this};k.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};k.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};k.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),f=d.next();if(f.done||f.value[0]!=b||"s"!=f.value[1])return!1;f=d.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!d.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var c=f(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};d.prototype.delete=function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!f(this,a).entry};
d.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};d.prototype.entries=function(){return e(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return e(this,function(a){return a.key})};d.prototype.values=function(){return e(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var f=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++k,c.set(b,d)):d="p_"+b;var f=a.data_[d];if(f&&$jscomp.owns(a.data_,d))for(a=0;a<f.length;a++){var e=f[a];if(b!==b&&e.key!==e.key||b===e.key)return{id:d,list:f,index:a,entry:e}}return{id:d,list:f,index:-1,entry:void 0}},e=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},k=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var e=c.entries(),g=e.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=e.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:e.next().done}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return c},"es6","es3");
Vue.component("lms-information-dialog",{template:'\n<v-dialog v-model="show" v-if="show" scrollable fullscreen>\n <v-card>\n  <v-card-title class="settings-title">\n   <v-toolbar color="primary" dark app class="lms-toolbar">\n    <v-btn flat icon @click.native="close()"><v-icon>arrow_back</v-icon></v-btn>\n    <v-toolbar-title>\n     <div>{{i18n(\'Information\')}}</div>\n    </v-toolbar-title>\n   </v-toolbar>\n  </v-card-title>\n  <div class="ios-vcard-text-workaround"><div class="infodetails" id="info-page">\n\n   <div v-if="server.length>0">\n    <p class="about-header">{{i18n(\'Server\')}}</p>\n    <ul>\n     <template v-for="(info, index) in server"><li>{{info.label}}: {{info.text}}</li></template>\n    </ul>\n    <v-btn @click="openSettings" flat><v-icon class="btn-icon">dns</v-icon>{{i18n(\'Server Settings\')}}</v-btn>\n    <div class="dialog-padding"></div>\n   </div>\n\n   <p class="about-header">{{i18n(\'Library\')}}</p>\n   <ul>\n    <template v-for="(item, index) in library"><li>{{item}}</li></template>\n   </ul>\n   <v-menu bottom v-if="!scanning">\n    <v-btn slot="activator" flat><v-icon class="btn-icon">refresh</v-icon>{{i18n(\'Rescan\')}} <v-icon>arrow_drop_down</v-icon></v-btn>\n    <v-list>\n     <template v-for="(item, index) in rescans">\n      <v-list-tile @click="initiateScan(item.prompt, item.command)">\n       <v-list-tile-title>{{item.title}}</v-list-tile-title>\n      </v-list-tile>\n     </template>\n    </v-list>\n   </v-menu>\n   <div class="dialog-padding" id="info-plugins"></div>\n\n   <p class="about-header">{{i18n(\'Plugins\')}}</p>\n   <p v-if="\'idle\'==pluginStatus && updates.details.length>0">{{i18n(\'The following plugins have updates available:\')}}</p>\n   <p v-if="\'needs_restart\'==pluginStatus && updates.details.length>0">{{i18n(\'The following plugins have been updated:\')}}</p>\n   <ul v-if="\'downloading\'!=pluginStatus && updates.details.length>0">\n    <template v-for="(plug, index) in updates.details"><li>{{plug.title}} {{plug.version}}<v-btn flat icon style="margin-top:2px;height:18px;width:18px" @click="pluginInfo(plug)"><v-icon small>help_outline</v-icon></v-btn></li></template>\n   </ul>\n   <v-btn v-if="updates.details.length>0 && \'idle\'==pluginStatus" @click="updatePlugins" flat><img class="svg-img btn-icon" :src="\'update\' | svgIcon(darkUi)">{{i18n(\'Update plugins\')}}</v-btn>\n   <p v-if="\'downloading\'==pluginStatus">{{i18n(\'Downloading plugin updates\')}}</p>\n   <v-btn v-if="\'needs_restart\'==pluginStatus" @click="restartServer" flat>{{i18n(\'Restart server\')}}</v-btn>\n   <p v-if="\'downloading\'!=pluginStatus && updates.details.length>0" style="padding-top:16px">{{i18n(\'The following plugins are up to date:\')}}</p>\n   <ul>\n    <template v-for="(plug, index) in plugins.details"><li v-if="\'downloading\'==pluginStatus || !updates.names.has(plug.name)">{{plug.title}} {{plug.version}}<v-btn flat icon style="margin-top:2px;height:18px;width:18px" @click="pluginInfo(plug)"><v-icon small>help_outline</v-icon></v-btn></li></template>\n   </ul>\n   <div class="dialog-padding"></div>\n\n   <p class="about-header">{{i18n(\'Players\')}}</p>\n   <ul>\n    <template v-for="(item, index) in players">\n     <li>{{item.name}}\n      <ul>\n       <template v-for="(info, index) in item.info"><li v-if="info!=\'\'">{{info}}</li></template>\n      </ul>\n     </li>\n    </template>\n   </ul>\n\n   <div class="dialog-padding"></div>\n\n   <p class="about-header">{{i18n(\'About\')}}</p>\n   <p>{{i18n(\'Material Skin is a HTML5 WebApp for LMS. For support, to report bugs, or ask for new features, please visit one of the following links:\')}}\n    <ul>\n     <li><a class="lms-link" href="https://forums.slimdevices.com/showthread.php?109624-Announce-Material-Skin" target="_blank">{{i18n(\'LMS support forums\')}}</a></li>\n     <li><a class="lms-link" href="https://github.com/CDrummond/lms-material" target="_blank">{{i18n(\'GitHub development page\')}}</a></li>\n    </ul>\n   </p>\n\n   <p>{{i18n(\'Material Skin is developed purely for fun, and no donations are required. However, if you wish to make a donation, please use the button below:\')}}</p>\n   <v-btn @click="openWindow(\'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=2X2CTDUH27V9L&source=url\')" flat><img class="svg-img btn-icon" :src="\'paypal\' | svgIcon(darkUi)"></img>{{i18n(\'Donate\')}}</v-btn>\n\n   <div class="dialog-padding"></div>\n   <v-divider></v-divider>\n   <div class="dialog-padding"></div>\n   <p>\u00a9 2018-2019 Craig Drummond</p>\n   <div class="dialog-padding"></div>\n  </div></div>\n </v-card>\n\n</v-dialog>\n',props:[],
data:function(){return{show:!1,server:[],library:[],players:[],plugins:{names:new Set,details:[]},updates:{names:new Set,details:[]},pluginStatus:"idle",rescans:[{title:void 0,prompt:void 0,command:["wipecache"]},{title:void 0,prompt:void 0,command:["rescan"]},{title:void 0,prompt:void 0,command:["rescan","playlists"]}],scanning:!1}},mounted:function(){bus.$on("info.open",function(a){var b=this;lmsCommand("",["material-skin","info"]).then(function(a){(a=a.data)&&a.result&&a.result.info&&(a=JSON.parse(a.result.info))&&
a.server&&(b.server=a.server)});this.update();this.timer=setInterval(function(){this.update()}.bind(this),2E3);this.show=!0;lmsCommand("",["material-skin","plugins"]).then(function(a){a=a.data;var c=0<b.plugins.names.length||0<b.updates.names.length;b.plugins.names.clear();b.plugins.details=[];if(a&&a.result&&a.result.plugins_loop){for(var f=0,e=a.result.plugins_loop.length;f<e;++f)b.plugins.names.add(a.result.plugins_loop[f].name);b.plugins.details=a.result.plugins_loop;b.plugins.details.sort(titleSort)}!c&&
b.$store.state.pluginUpdatesAvailable&&b.scrollToPlugins()});axios.get(location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/updateinfo.json?x=time"+(new Date).getTime()).then(function(a){var c=0<b.plugins.names.length||0<b.updates.names.length;a=eval(a.data);b.updates.names.clear();b.updates.details=[];if(a&&a.plugins){for(var f=0,e=a.plugins.length;f<e;++f)b.updates.names.add(a.plugins[f].name);b.updates.details=a.plugins;b.updates.details.sort(titleSort);b.$forceUpdate()}b.$store.commit("setPluginUpdatesAvailable",
a&&a.plugins&&0<a.plugins.length);!c&&b.$store.state.pluginUpdatesAvailable&&b.scrollToPlugins()}).catch(function(a){b.updates.names.clear();logError(a)});this.scrollToPlugins()}.bind(this));bus.$on("langChanged",function(){this.initItems()}.bind(this));this.initItems();bus.$on("esc",function(){"info"==this.$store.state.activeDialog&&(this.show=!1)}.bind(this))},methods:{initItems:function(){this.rescans[0].title=i18n("Full rescan");this.rescans[0].prompt=i18n("Clear library, and rescan everything?");
this.rescans[1].title=i18n("Update rescan");this.rescans[1].prompt=i18n("Look for new, and modified, files?");this.rescans[2].title=i18n("Update playlists");this.rescans[2].prompt=i18n("Rescan for playlist changes?")},scrollToPlugins:function(){if(this.$store.state.pluginUpdatesAvailable){var a=document.getElementById("info-plugins");a&&a.scrollIntoView(!0)}},update:function(){var a=this;lmsCommand("",["material-skin","plugins-status"]).then(function(b){if((b=b.data)&&b.result){var c="idle";1==parseInt(b.result.downloading)?
c="downloading":1==parseInt(b.result.needs_restart)&&(c="needs_restart");c!=a.pluginStatus&&(a.pluginStatus=c)}});lmsCommand("",["serverstatus",0,LMS_MAX_PLAYERS]).then(function(b){if((b=b.data)&&b.result){for(var c={},d=0,f=a.players.length;d<f;++d){var e=a.players[d];0<e.sigStrength&&(c[e.id]=e.sigStrength)}a.players=[];if(b.result.players_loop)for(d=0,f=b.result.players_loop.length;d<f;++d){e=b.result.players_loop[d];var g="group"===e.model,k=[i18n("Model: %1",e.modelname),i18n("Type: %1",e.model),
i18n("Firmware: %1",e.firmware),i18n("IP: %1",e.ip.split(":")[0]),i18n("MAC Address: %1",e.playerid),""];void 0!=c[e.playerid]&&(k[5]=i18n("Signal Strength: %1%",c[e.playerid]));a.players.push({name:e.name,id:e.playerid,info:k,isgroup:g});g||lmsCommand(e.playerid,["signalstrength","?"]).then(function(b){if((b=b.data)&&b.result&&0<b.result._signalstrength)for(var c=0,d=a.players.length;c<d;++c){var e=a.players[c];e.id==b.params[0]&&(e.info[5]=i18n("Signal Strength: %1%",b.result._signalstrength),e.sigStrength=
b.result._signalstrength)}})}a.players.sort(playerSort);a.scanning=void 0==b.result.lastscan||1==b.result.scanning;a.library=[i18n("Total genres: %1",b.result["info total genres"]),i18n("Total artists: %1",b.result["info total artists"]),i18n("Total albums: %1",b.result["info total albums"]),i18n("Total songs: %1",b.result["info total songs"]),i18n("Total duration: %1",formatSeconds(b.result["info total duration"],!0)),i18n("Last scan: %1",a.scanning?i18n("In progress"):formatDate(b.result.lastscan))];
b.result.lastscanfailed&&a.library.push("Last scan failure: %1",b.result.lastscanfailed)}})},close:function(){this.show=!1;this.timer&&(clearInterval(this.timer),this.timer=void 0)},initiateScan:function(a,b){this.$confirm(a,{buttonTrueText:i18n("Rescan"),buttonFalseText:i18n("Cancel")}).then(function(a){a&&lmsCommand("",b)})},pluginInfo:function(a){bus.$emit("dlg.open","iteminfo",a)},updatePlugins:function(){var a=this;lmsCommand("",["material-skin","plugins-update","plugins:"+JSON.stringify(this.updates.details)]).then(function(b){(b=
b.data)&&b.result&&void 0!=b.result.updating&&0<parseInt(b.result.updating)&&(bus.$emit("showMessage",i18n("Updating plugins.")),a.update())})},restartServer:function(){var a=this;lmsCommand("",["restartserver"]).then(function(b){a.close();bus.$emit("showMessage",i18n("Server is being restarted."))}).catch(function(b){a.close();bus.$emit("showMessage",i18n("Server is being restarted."))})},i18n:function(a){return this.show?i18n(a):a},openSettings:function(){bus.$emit("dlg.open","iframe","/material/settings/server/basic.html",
i18n("Server settings"))}},beforeDestroy:function(){void 0!==this.timer&&(clearInterval(this.timer),this.timer=void 0)},watch:{show:function(a){this.$store.commit("dialogOpen",{name:"info",shown:a})}},computed:{darkUi:function(){return this.$store.state.darkUi}},filters:{svgIcon:function(a,b){return"/material/svg/"+a+"?c="+(b?LMS_DARK_SVG:LMS_LIGHT_SVG)+"&r="+LMS_MATERIAL_REVISION}}});
