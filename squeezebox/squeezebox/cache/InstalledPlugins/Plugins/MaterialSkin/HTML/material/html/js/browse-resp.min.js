var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},d=Object.create(new $jscomp.global.Proxy(b,{get:function(e,l,c){return e==b&&"q"==l&&c==d}}));return!0===d.q}catch(e){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(b){var d=0;return function(){return d<b.length?{done:!1,value:b[d++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,e){b!=Array.prototype&&b!=Object.prototype&&(b[d]=e.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.makeIterator=function(b){var d="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return d?d.call(b):$jscomp.arrayIterator(b)};$jscomp.owns=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};$jscomp.polyfill=function(b,d,e,l){if(d){e=$jscomp.global;b=b.split(".");for(l=0;l<b.length-1;l++){var c=b[l];c in e||(e[c]={});e=e[c]}b=b[b.length-1];l=e[b];d=d(l);d!=l&&null!=d&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("WeakMap",function(b){function d(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),a=new b([[c,2],[d,3]]);if(2!=a.get(c)||3!=a.get(d))return!1;a.delete(c);a.set(d,4);return!a.has(c)&&4==a.get(d)}catch(k){return!1}}function e(){}function l(b){if(!$jscomp.owns(b,h)){var c=new e;$jscomp.defineProperty(b,h,{value:c})}}function c(b){var c=Object[b];c&&(Object[b]=function(a){if(a instanceof e)return a;l(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&
$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;var h="$jscomp_hidden_"+Math.random();c("freeze");c("preventExtensions");c("seal");var g=0,m=function(b){this.id_=(g+=Math.random()+1).toString();if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};m.prototype.set=function(b,c){l(b);if(!$jscomp.owns(b,h))throw Error("WeakMap key fail: "+b);b[h][this.id_]=c;return this};m.prototype.get=function(b){return $jscomp.owns(b,h)?b[h][this.id_]:void 0};m.prototype.has=
function(b){return $jscomp.owns(b,h)&&$jscomp.owns(b[h],this.id_)};m.prototype.delete=function(b){return $jscomp.owns(b,h)&&$jscomp.owns(b[h],this.id_)?delete b[h][this.id_]:!1};return m},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function d(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b($jscomp.makeIterator([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var a=d.entries(),e=a.next();if(e.done||e.value[0]!=c||"s"!=e.value[1])return!1;e=a.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!a.next().done?!1:!0}catch(B){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;$jscomp.initSymbolIterator();var e=new WeakMap,l=function(b){this.data_={};this.head_=g();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};l.prototype.set=function(b,d){b=0===b?0:b;var a=c(this,b);a.list||(a.list=this.data_[a.id]=[]);a.entry?a.entry.value=d:(a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,
value:d},a.list.push(a.entry),this.head_.previous.next=a.entry,this.head_.previous=a.entry,this.size++);return this};l.prototype.delete=function(b){b=c(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};l.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};l.prototype.has=function(b){return!!c(this,b).entry};
l.prototype.get=function(b){return(b=c(this,b).entry)&&b.value};l.prototype.entries=function(){return h(this,function(b){return[b.key,b.value]})};l.prototype.keys=function(){return h(this,function(b){return b.key})};l.prototype.values=function(){return h(this,function(b){return b.value})};l.prototype.forEach=function(b,c){for(var a=this.entries(),d;!(d=a.next()).done;)d=d.value,b.call(c,d[1],d[0],this)};l.prototype[Symbol.iterator]=l.prototype.entries;var c=function(b,c){var a=c&&typeof c;"object"==
a||"function"==a?e.has(c)?a=e.get(c):(a=""+ ++m,e.set(c,a)):a="p_"+c;var d=b.data_[a];if(d&&$jscomp.owns(b.data_,a))for(b=0;b<d.length;b++){var l=d[b];if(c!==c&&l.key!==l.key||c===l.key)return{id:a,list:d,index:b,entry:l}}return{id:a,list:d,index:-1,entry:void 0}},h=function(b,c){var a=b.head_;return $jscomp.iteratorPrototype(function(){if(a){for(;a.head!=b.head_;)a=a.previous;for(;a.next!=a.head;)return a=a.next,{done:!1,value:c(a)};a=null}return{done:!0,value:void 0}})},g=function(){var b={};return b.previous=
b.next=b.head=b},m=0;return l},"es6","es3");
$jscomp.polyfill("Set",function(b){function d(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),c=new b($jscomp.makeIterator([d]));if(!c.has(d)||1!=c.size||c.add(d)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var e=c.entries(),g=e.next();if(g.done||g.value[0]!=d||g.value[1]!=d)return!1;g=e.next();return g.done||g.value[0]==d||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:e.next().done}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;$jscomp.initSymbolIterator();var e=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.map_.size};e.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};e.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};e.prototype.clear=function(){this.map_.clear();
this.size=0};e.prototype.has=function(b){return this.map_.has(b)};e.prototype.entries=function(){return this.map_.entries()};e.prototype.values=function(){return this.map_.values()};e.prototype.keys=e.prototype.values;e.prototype[Symbol.iterator]=e.prototype.values;e.prototype.forEach=function(b,c){var d=this;this.map_.forEach(function(e){return b.call(c,e,e,d)})};return e},"es6","es3");
$jscomp.checkStringArgs=function(b,d,e){if(null==b)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(b,e){var d=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var c=d.length,h=b.length;e=Math.max(0,Math.min(e|0,d.length));for(var g=0;g<h&&e<c;)if(d[e++]!=b[g++])return!1;return g>=h}},"es6","es3");var MORE_COMMANDS=new Set(["item_add","item_insert","itemplay"]);
function parseBrowseResp(b,d,e,l){var c={items:[],baseActions:[],canUseGrid:!1,jumplist:[]};try{if(b&&b.result){logJsonMessage("RESP",b);if(d&&SEARCH_ID===d.id){for(var h=0,g=d=0,m=0,r=0,q=0,a=0,k=b.params[1],B=k.length;a<B;++a)if((""+k[a]).startsWith("term:")){k[a].substr(4);break}b.result.contributors_loop&&0<b.result.contributors_loop.length&&(g=b.result.contributors_loop.length>LMS_SEARCH_LIMIT?LMS_SEARCH_LIMIT:b.result.contributors_loop.length,d+=1);b.result.albums_loop&&0<b.result.albums_loop.length&&
(m=b.result.albums_loop.length>LMS_SEARCH_LIMIT?LMS_SEARCH_LIMIT:b.result.albums_loop.length,d+=1);b.result.tracks_loop&&0<b.result.tracks_loop.length&&(r=b.result.tracks_loop.length>LMS_SEARCH_LIMIT?LMS_SEARCH_LIMIT:b.result.tracks_loop.length,d+=1);b.result.genres_loop&&0<b.result.genres_loop.length&&(q=b.result.genres_loop.length>LMS_SEARCH_LIMIT?LMS_SEARCH_LIMIT:b.result.genres_loop.length,d+=1);if(b.result.contributors_loop&&0<g){h+=g;var v=[],t=g>LMS_INITIAL_SEARCH_RESULTS,w=t?LMS_INITIAL_SEARCH_RESULTS:
g,x=t?w+" / "+g:g;1<d?c.items.push({title:i18np("1 Artist","%1 Artists",x),id:"search.artists",header:!0,allSearchResults:v,subtitle:i18np("1 Artist","%1 Artists",g)}):c.subtitle=i18np("1 Artist","%1 Artists",x);var u=getLocalStorageBool("infoPlugin"),f=0;for(k=b.result.contributors_loop;f<g;++f){a=k[f];var p={id:"artist_id:"+a.contributor_id,title:a.contributor,command:["albums"],params:["artist_id:"+a.contributor_id,ALBUM_TAGS,SORT_KEY+ARTIST_ALBUM_SORT_PLACEHOLDER],image:u&&e.artistImages?"/imageproxy/mai/artist/"+
a.contributor_id+"/image"+LMS_IMAGE_SIZE:void 0,menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,ADD_RANDOM_ALBUM_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group"};f<w&&c.items.push(p);t&&v.push(p)}}if(b.result.albums_loop&&0<m)for(h+=m,v=[],w=(t=m>LMS_INITIAL_SEARCH_RESULTS)?LMS_INITIAL_SEARCH_RESULTS:m,x=t?w+" / "+m:m,1<d||t?c.items.push({title:i18np("1 Album","%1 Albums",x),id:"search.albums",header:!0,allSearchResults:v,subtitle:i18np("1 Album","%1 Albums",m),menu:[PLAY_ALL_ACTION,
ADD_ALL_ACTION]}):c.subtitle=i18np("1 Album","%1 Albums",x),f=0,k=b.result.albums_loop;f<m;++f)a=k[f],p={id:"album_id:"+a.album_id,artist_id:a.artist_id,title:a.album,command:["tracks"],params:["album_id:"+a.album_id,TRACK_TAGS,SORT_KEY+"tracknum"],image:"/music/"+(""==a.artwork||void 0==a.artwork?"0":a.artwork)+"/cover"+LMS_IMAGE_SIZE,menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group"},f<w&&c.items.push(p),t&&v.push(p);if(b.result.tracks_loop&&
0<r)for(h+=r,v=[],w=(t=r>LMS_INITIAL_SEARCH_RESULTS)?LMS_INITIAL_SEARCH_RESULTS:r,x=t?w+" / "+r:r,1<d||t?c.items.push({title:i18np("1 Track","%1 Tracks",x),id:"search.tracks",header:!0,allSearchResults:v,subtitle:i18np("1 Track","%1 Tracks",r),menu:[PLAY_ALL_ACTION,ADD_ALL_ACTION]}):c.subtitle=i18np("1 Track","%1 Tracks",x),f=0,k=b.result.tracks_loop;f<r;++f)a=k[f],p={id:"track_id:"+a.track_id,title:a.track,image:"/music/"+(""==a.coverid||void 0==a.coverid?"0":a.coverid)+"/cover"+LMS_IMAGE_SIZE,menu:[PLAY_ACTION,
INSERT_ACTION,ADD_ACTION,DIVIDER,SELECT_ACTION,MORE_LIB_ACTION],type:"track"},f<w&&c.items.push(p),t&&v.push(p);if(b.result.genres_loop&&0<q)for(h+=q,v=[],w=(t=q>LMS_INITIAL_SEARCH_RESULTS)?LMS_INITIAL_SEARCH_RESULTS:q,x=t?w+" / "+q:q,1<d||t?c.items.push({title:i18np("1 Genre","%1 Genres",x),id:"search.genres",header:!0,allSearchResults:v,subtitle:i18np("1 Genre","%1 Genres",q)}):c.subtitle=i18np("1 Genre","%1 Genres",x),f=0,k=b.result.genres_loop;f<q;++f)a=k[f],p={id:"genre_id:"+a.genre_id,title:a.genre,
command:["artists"],params:["genre_id:"+a.genre_id],menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,ADD_RANDOM_ALBUM_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group"},f<w&&c.items.push(p),t&&v.push(p);if(0==d||1<d)c.subtitle=i18np("1 Item","%1 Items",h)}else if(b.result.item_loop){x=w=t=v=!1;var D=b&&b.params&&1<b.params.length&&b.params[1]&&1<b.params[1].length?b.params[1][0]:void 0;q=d&&d.isFavFolder?!0:!1;var F=d&&d.section==SECTION_PLAYLISTS,L=d&&d.section==SECTION_RADIO,
R=L&&d.id==TOP_RADIO_ID,M=d&&d.id==TOP_APPS_ID,N="podcasts"==D&&5==b.params[1].length&&"items"==b.params[1][1]&&"menu:podcasts"==b.params[1][4],S="browselibrary"==D&&5<=b.params[1].length&&0<b.params[1].indexOf("mode:bmf"),z=!1,y=!1;q&&(new Date).getTime().toString(16);var G=void 0,A=new Set;D="trackstat"!=D&&!q;u=void 0;c.canUseGrid=D&&b.result.window&&b.result.window.windowStyle&&"icon_list"==b.result.window.windowStyle?!0:!1;b.result.base&&b.result.base.actions&&(c.baseActions=b.result.base.actions,
v=void 0!=c.baseActions[ACTIONS[PLAY_ACTION].cmd],t=void 0!=c.baseActions[ACTIONS[ADD_ACTION].cmd],w=void 0!=c.baseActions[ACTIONS[INSERT_ACTION].cmd],x=void 0!=c.baseActions[ACTIONS[MORE_ACTION].cmd],c.baseActions[ACTIONS[PLAY_ACTION].cmd]&&c.baseActions[ACTIONS[PLAY_ACTION].cmd].params&&c.baseActions[ACTIONS[PLAY_ACTION].cmd].params.menu&&(G=c.baseActions[ACTIONS[PLAY_ACTION].cmd].params.menu));f=0;k=b.result.item_loop;for(h=k.length;f<h;++f)if(a=k[f],a.text&&1!=a.showBigArtwork)if(c.items.length!=
b.result.count-1||"playlist"!=a.type||"html/images/albums.png"!=a["icon-id"]||q){var C=!1;if("text"==a.type){if(a.style&&MORE_COMMANDS.has(a.style)){b.result.count--;continue}a.title=replaceNewLines(a.text)}else{var J=a.text.split(/\r?\n/);a.title=J[0];1<J.length?a.subtitle=J[1]:a.title=a.text}if(!a.type&&!a.style&&a.actions&&a.actions.go&&a.actions.go.params)for(g in a.actions.go.params)a.actions.go.params[g]==TERM_PLACEHOLDER&&(a.type="entry");void 0!=a.type||a.style||!a.actions||!a.actions.go||
a.icon||a["icon-id"]||a.image||a.window||a.addAction&&!a.actions.go.nextWindow||(a.type="text");a.text=void 0;a.image=resolveImage(a.icon?a.icon:a["icon-id"],void 0,LMS_IMAGE_SIZE);!a.image&&a.commonParams&&a.commonParams.album_id&&(a.image=resolveImage("music/0/cover"+LMS_IMAGE_SIZE));a.image?z=!0:y=!0;a.menu=[];if("artist"==a.type||"album"==a.type||"year"==a.type||"genre"==a.type||"playlist"==a.type||"audio"==a.type||"itemplay"==a.style||a.goAction&&("playControl"==a.goAction||"play"==a.goAction))if(a.params&&
hasPlayableId(a.params)||a.commonParams&&hasPlayableId(a.commonParams)||a.actions&&a.actions.add&&a.actions.add.params&&hasPlayableId(a.actions.add.params))v&&(a.menu.push(PLAY_ACTION),C=!0),w&&(a.menu.push(INSERT_ACTION),C=!0),t&&(a.menu.push(ADD_ACTION),C=!0);var n=!1;q?(a.pos=c.items.length,0<a.menu.length&&(a.menu.push(DIVIDER),n=!0),a.type||(a.isFavFolder=!0),a.menu.push(a.isFavFolder?DELETE_FAV_FOLDER_ACTION:REMOVE_FROM_FAV_ACTION),a.menu.push(a.isFavFolder?RENAME_ACTION:EDIT_ACTION),void 0!=
d&&d.id!=TOP_FAVORITES_ID&&a.menu.push(MOVE_FAV_TO_PARENT_ACTION),!a.isFavFolder||a.image&&!a.image.startsWith("/html/images/favorites"+LMS_IMAGE_SIZE)?a.isFavFolder||void 0==a.presetParams||void 0==a.presetParams.favorites_url?"html/images/favorites.png"==a["icon-id"]&&(a.icon="favorite",a.image=void 0):a.presetParams.favorites_url.startsWith("db:album.title")&&"html/images/albums.png"==a.presetParams.icon?(a.icon="album",a.image=void 0):a.presetParams.favorites_url.startsWith("db:contributor.name")?
(void 0==u&&(u=getLocalStorageBool("infoPlugin")),"html/images/artists.png"!=a.presetParams.icon&&u&&e.artistImages||(a.svg="artist",a.image=void 0)):a.presetParams.favorites_url.startsWith("db:genre.name")&&"html/images/genres.png"==a.presetParams.icon?(a.icon="label",a.image=void 0):a.presetParams.favorites_url.startsWith("db:year.id")&&"html/images/years.png"==a.presetParams.icon?(a.icon="date_range",a.image=void 0):a.presetParams.favorites_url.startsWith("file://")&&"html/images/playlists.png"==
a.presetParams.icon?(a.icon="list",a.image=void 0):a.presetParams.favorites_url.startsWith("dynamicplaylist://")&&"plugins/DynamicPlayList/html/images/dynamicplaylist.png"==a.presetParams.icon?(a.svg="dice-list",a.image=void 0):"html/images/radio.png"==a.presetParams.icon?(a.svg="radio-tower",a.image=void 0):"html/images/favorites.png"==a["icon-id"]&&(a.icon="favorite",a.image=void 0):(a.icon="folder",a.image=void 0),!a.isFavFolder&&e.showPresets&&a.menu.push(SAVE_PRESET_ACTION)):a.presetParams&&
(0<a.menu.length&&(a.menu.push(DIVIDER),n=!0),a.menu.push(ADD_TO_FAV_ACTION),e.showPresets&&a.menu.push(SAVE_PRESET_ACTION));F&&"playlist"==a.type&&(!n&&0<a.menu.length&&(a.menu.push(DIVIDER),n=!0),a.menu.push(RENAME_ACTION),a.menu.push(DELETE_ACTION));N&&(!n&&0<a.menu.length&&(a.menu.push(DIVIDER),n=!0),a.menu.push(REMOVE_PODCAST_ACTION));if(!a.type&&a.actions&&a.actions.go&&a.actions.go.params)for(m=0,r=a.actions.go.params.length;m<r;++m)if(TERM_PLACEHOLDER==a.actions.go.params[m]){a.type="search";
break}!a.type&&a.style&&"itemNoAction"==a.style&&(a.type="text");M&&a.actions&&a.actions.go&&a.actions.go.params&&a.actions.go.params.menu?("myapps"==a.actions.go.params.menu?a.actions.go.params.item_id&&(a.id=fixId(a.actions.go.params.item_id,"myapps")):a.id="apps."+a.actions.go.params.menu,a.id&&(!n&&0<a.menu.length&&(a.menu.push(DIVIDER),n=!0),a.menu.push(e.pinned.has(a.id)?UNPIN_ACTION:PIN_ACTION))):F&&a.commonParams&&a.commonParams.playlist_id?a.id="playlist_id:"+a.commonParams.playlist_id:L?
("search"!=a.type&&(a.id||(a.id=a.params&&a.params.item_id?fixId(a.params.item_id,void 0==G?"radio":G):a.presetParams&&a.presetParams.favorites_url?"radio:"+a.presetParams.favorites_url:a.actions&&a.actions.go&&a.actions.go.params&&a.actions.go.params.item_id?"item_id:"+a.actions.go.params.item_id:d&&d.id&&TOP_RADIO_ID!=d.id?d.id+"."+a.title:"radio:"+a.title),0<a.menu.length&&(a.icon||a.image)&&"entry"!=a.type&&a.presetParams&&a.presetParams.favorites_url?(!n&&0<a.menu.length&&(a.menu.push(DIVIDER),
n=!0),a.isRadio=!0,a.menu.push(e.pinned.has(a.id)?UNPIN_ACTION:PIN_ACTION)):"radios"==b.params[1][0]&&"entry"!=a.type&&a.actions&&a.actions.go&&a.actions.go.params&&a.actions.go.params.menu&&(a.id="radio:"+a.actions.go.params.menu,a.menu.push(e.pinned.has(a.id)?UNPIN_ACTION:PIN_ACTION))),R&&a["icon-id"]&&(a.actions&&a.actions.go&&a.actions.go.params&&"language"==a.actions.go.params.menu&&(a["icon-id"]="language.png"),mapIcon(a,"radio"))):S?a.icon="playlist"==a.type?a.actions&&a.actions.play&&a.actions.play.params&&
a.actions.play.params.folder_id?"folder":"list":isPlaylist(a.title)?"list":"audio"==a.type?"music_note":"crop_portrait":(mapIcon(a),q||(a.params&&a.params.item_id?a.id="item_id:"+a.params.item_id:a.actions&&a.actions.go&&a.actions.go.params&&a.actions.go.params.item_id&&(a.id="item_id:"+a.actions.go.params.item_id)));a.id||(d.id.startsWith(TOP_ID_PREFIX)?a.id="item_id:"+c.items.length:a.id=d.id+"."+c.items.length);!a.type&&a.params&&a.params.track&&(a.type="audio");C&&(n||(a.menu.push(DIVIDER),n=
!0),a.menu.push(SELECT_ACTION));!q&&(a.commonParams&&(a.commonParams.artist_id||a.commonParams.album_id||a.commonParams.track_id)||(x&&0<a.menu.length&&a.params&&a.params.item_id||a.actions&&a.actions.more&&a.actions.more.cmd)&&!(a.actions&&a.actions.go&&a.actions.go.params&&a.actions.go.params.year))&&(!n&&0<a.menu.length&&a.menu.push(DIVIDER),a.menu.push(MORE_ACTION));a.section=d?d.section:void 0;g=a.textkey;void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,
index:c.items.length});q&&(a.draggable=!0,a.realIndex=c.items.length);"text"==a.type&&a.title.startsWith("<")&&(a.type="html");c.items.push(a);A.add(a.type)}else b.result.count--;else b.result.count--;c.canUseGrid&&(A.has("text")||A.has("search")||A.has("entry"))?c.canUseGrid=!1:c.canUseGrid||!D||!z||1!=A.size||A.has("text")||A.has("search")||A.has("entry")||A.has(void 0)||(c.canUseGrid=!0);if(0==c.items.length&&b.result.window&&b.result.window.textarea)c.items.push({title:replaceNewLines(b.result.window.textarea),
type:"text",id:d.id+".0"}),c.canUseGrid=!1;else if(y&&z){var T=resolveImage("music/0/cover"+LMS_IMAGE_SIZE),U=resolveImage("html/images/artists"+LMS_IMAGE_SIZE);a=0;for(B=c.items.length;a<B;++a)p=c.items[a],p.image||("album"==p.type||p.window&&"album"==p.window.titleStyle&&"album"==p.window.menuStyle&&p.actions&&p.actions.go?p.image=T:"artist"==p.type?p.image=U:(c.canUseGrid=!1,p.image=LMS_BLANK_IMAGE))}M||N?c.items.sort(titleSort):q&&c.items.sort(e.sortFavorites?favSort:partialFavSort)}else if(b.result.artists_loop){z=
[];F=q=p=!1;if(b.params&&1<b.params.length)for(a=3,B=b.params[1].length;a<B;++a)if("string"===typeof b.params[1][a]||b.params[1][a]instanceof String)if(y=b.params[1][a].toLowerCase(),y.startsWith("role_id:")||!lmsOptions.noGenreFilter&&y.startsWith("genre_id:"))z.push(b.params[1][a]),"role_id:composer"==y?p=!0:"role_id:conductor"==y?q=!0:"role_id:band"==y&&(F=!0);u=getLocalStorageBool("infoPlugin");c.canUseGrid=u&&e.artistImages;f=0;k=b.result.artists_loop;for(h=k.length;f<h;++f){a=k[f];g=a.textkey;
void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,index:c.items.length});C={id:"artist_id:"+a.id,title:a.artist,command:["albums"],image:u&&e.artistImages?"/imageproxy/mai/artist/"+a.id+"/image"+LMS_IMAGE_SIZE:void 0,params:["artist_id:"+a.id,"tags:jlys",SORT_KEY+ARTIST_ALBUM_SORT_PLACEHOLDER],menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,ADD_RANDOM_ALBUM_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group",textkey:g};m=0;for(r=z.length;m<
r;++m)C.params.push(z[m]);c.items.push(C)}c.subtitle=p?i18np("1 Composer","%1 Composers",c.items.length):q?i18np("1 Conductor","%1 Conductors",c.items.length):F?i18np("1 Band","%1 Bands",c.items.length):i18np("1 Artist","%1 Artists",c.items.length);d&&d.id&&d.id.startsWith("search:")&&(c.jumplist=[])}else if(b.result.albums_loop){c.actions=[ADD_ACTION,DIVIDER,PLAY_ACTION];c.canUseGrid=!0;e=!1;z=[];if(b.params&&1<b.params.length)for(a=3,r=b.params[1].length;a<r;++a)if("string"===typeof b.params[1][a]||
b.params[1][a]instanceof String)y=b.params[1][a].toLowerCase(),!lmsOptions.noRoleFilter&&y.startsWith("role_id:")||!lmsOptions.noGenreFilter&&y.startsWith("genre_id:")||y.startsWith("artist_id:")?z.push(b.params[1][a]):y.startsWith("sort:year")&&(e=!0);f=0;k=b.result.albums_loop;for(h=k.length;f<h;++f){a=k[f];n=a.album;a.year&&0<a.year&&(n+=" ("+a.year+")");g=e?""+a.year:a.textkey;void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,index:c.items.length});
var O={id:"album_id:"+a.id,artist_id:a.artist_id,title:n,subtitle:a.artist?a.artist:void 0,command:["tracks"],image:"/music/"+a.artwork_track_id+"/cover"+LMS_IMAGE_SIZE,params:["album_id:"+a.id,TRACK_TAGS,SORT_KEY+"tracknum"],menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group",origTitle:a.album,textkey:g};m=0;for(r=z.length;m<r;++m)O.params.push(z[m]);c.items.push(O)}c.subtitle=i18np("1 Album","%1 Albums",c.items.length);d&&d.id&&d.id.startsWith("search:")&&
(c.jumplist=[])}else if(b.result.titles_loop){c.actions=[ADD_ACTION,DIVIDER,PLAY_ACTION];var E=0,K=d&&d.id&&d.id.startsWith("album_id:");if(!K&&4<=b.params[1].length&&"tracks"==b.params[1][0])for(m=0,r=b.params[1].length;m<r;++m)if((""+b.params[1][m]).startsWith("album_id:")){K=!0;break}u=[PLAY_ACTION];K&&1<b.result.count&&u.push(PLAY_ALBUM_ACTION);u.push(INSERT_ACTION);u.push(ADD_ACTION);u.push(DIVIDER);e.ratingsSupport&&u.push(RATING_ACTION);u.push(SELECT_ACTION);u.push(MORE_LIB_ACTION);f=0;k=b.result.titles_loop;
for(h=k.length;f<h;++f)a=k[f],n=a.title,0<a.tracknum&&(n=(9<a.tracknum?a.tracknum:"0"+a.tracknum)+SEPARATOR+n),a.trackartist&&(a.albumartist&&a.trackartist!==a.albumartist||!a.albumartist&&"1"==a.compilation)?n+=SEPARATOR+a.trackartist:a.artist&&(a.albumartist&&a.artist!==a.albumartist||!a.albumartist&&"1"==a.compilation)&&(n+=SEPARATOR+a.artist),E+=parseFloat(a.duration||0),c.items.push({id:"track_id:"+a.id,title:n,subtitle:void 0!=a.rating?ratingString(formatSeconds(a.duration),a.rating):formatSeconds(a.duration),
menu:u,type:"track",rating:a.rating});c.subtitle=i18np("1 Track","%1 Tracks",c.items.length);d&&d.id&&d.id.startsWith("search:")||(c.subtitle+=" ("+formatSeconds(E)+")")}else if(b.result.genres_loop){f=0;k=b.result.genres_loop;for(h=k.length;f<h;++f)a=k[f],g=a.textkey,void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,index:c.items.length}),c.items.push({id:"genre_id:"+a.id,title:a.genre,command:["artists"],params:["genre_id:"+a.id],menu:[PLAY_ACTION,INSERT_ACTION,
ADD_ACTION,ADD_RANDOM_ALBUM_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION,MORE_LIB_ACTION],type:"group",textkey:g});c.subtitle=i18np("1 Genre","%1 Genres",c.items.length)}else if(b.result.playlists_loop){G=e.showPresets?[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SAVE_PRESET_ACTION,RENAME_ACTION,DELETE_ACTION,SELECT_ACTION]:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,ADD_TO_FAV_ACTION,RENAME_ACTION,DELETE_ACTION,SELECT_ACTION];f=0;k=b.result.playlists_loop;for(h=k.length;f<
h;++f)a=k[f],g=a.textkey,void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,index:c.items.length}),c.items.push({id:"playlist_id:"+a.id,title:a.playlist,command:["playlists","tracks"],params:["playlist_id:"+a.id,"tags:acdltK"],menu:G,type:"group",section:SECTION_PLAYLISTS,url:a.url});c.subtitle=i18np("1 Playlist","%1 Playlists",c.items.length)}else if(b.result.playlisttracks_loop){c.actions=[ADD_ACTION,DIVIDER,PLAY_ACTION];f=e=0;k=b.result.playlisttracks_loop;
for(h=k.length;f<h;++f){a=k[f];n=a.title;a.artist&&(n+=SEPARATOR+a.artist);n||(n=i18n("Unknown"));E=parseFloat(a.duration||0);e+=E;var I=0<E?formatSeconds(E):void 0;a.album&&(I=I?I+(SEPARATOR+a.album):a.album);c.items.push({id:uniqueId("track_id:"+a.id,c.items.length),title:n,subtitle:I,image:a.artwork_url?resolveImageUrl(a.artwork_url,LMS_IMAGE_SIZE):"/music/"+(""==a.coverid||void 0==a.coverid?"0":a.coverid)+"/cover"+LMS_IMAGE_SIZE,menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,REMOVE_ACTION,
SELECT_ACTION],type:"track",draggable:!0})}c.subtitle=i18np("1 Track","%1 Tracks",c.items.length);0<e&&(c.subtitle+=" ("+formatSeconds(e)+")")}else if(b.result.years_loop){f=0;k=b.result.years_loop;for(h=k.length;f<h;++f)a=k[f],g=a.textkey,void 0==g||0!=c.jumplist.length&&c.jumplist[c.jumplist.length-1].key==g||c.jumplist.push({key:g,index:c.items.length}),c.items.push({id:"year:"+a.year,title:a.year,command:["albums"],params:["year:"+a.year,"tags:ajlys"],menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,
ADD_RANDOM_ALBUM_ACTION,DIVIDER,ADD_TO_FAV_ACTION,SELECT_ACTION],type:"group",textkey:g});c.subtitle=i18np("1 Year","%1 Years",c.items.length)}else if(b&&b.result&&b.result.presets_loop){f=0;k=b.result.presets_loop;for(h=k.length;f<h;++f)a=k[f],n=void 0!=a.text?a.text.trim():a.text,c.items.push({title:(10>parseInt(a.num)?"0":"")+a.num+(void 0!=n&&0<n.length?SEPARATOR+n:""),text:a.text,url:a.url,menu:[PLAY_ACTION,INSERT_ACTION,ADD_ACTION,DIVIDER,REMOVE_ACTION,EDIT_ACTION,MOVE_PRESET_ACTION],section:SECTION_PRESETS,
num:a.num});c.subtitle=i18np("1 Item","%1 Items",c.items.length)}else if(0===b.result.count&&b.result.networkerror)c.items.push({title:i18n("Failed to retrieve listing. (%1)",b.result.networkerror),type:"text"});else if(b.result.data&&b.result.data.constructor===Array&&b.result.title){f=0;k=b.result.data;for(h=k.length;f<h;++f)a=k[f],a.image&&(a.id="image:"+c.items.length,a.type="image",a.thumb=resolveImageUrl(a.image,LMS_IMAGE_SIZE),a.src=resolveImageUrl(a.image),a.w=0,a.h=0,c.items.push(a));0<c.items.length&&
(c.title=b.result.title,c.subtitle=i18np("1 Image","%1 Images",c.items.length),c.canUseGrid=c.forceGrid=!0)}b.result.count>LMS_BATCH_SIZE&&(c.subtitle=i18n("Only showing %1 items",LMS_BATCH_SIZE));if(l&&lmsLastScan&&canUseCache&&(c.iscache=!0,idbKeyval.set(l,c),b.params&&1<b.params.length&&0<b.params[1].length&&"albums"==b.params[1][0])){var H=l.split("-"+SORT_KEY);if(2==H.length&&(H=H[1].split("-"),1<H.length)){var P=H[0];b=["album","artistalbum","artflow","yearalbum","yearartistalbum"];a=0;for(B=
b.length;a<B;++a)if(b[a]!=P){var V=l.replace(SORT_KEY+P,SORT_KEY+b[a]);idbKeyval.del(V)}}}}else b&&b.iscache&&(c=b);0==c.items.length&&c.items.push({title:i18n("Empty"),type:"text",id:"empty"})}catch(Q){c.items.push({title:i18n("ERROR: List processing failed")+"\n"+Q,type:"text",id:"error"}),logError(Q)}return c}
function parseBrowseUrlResp(b,d){var e={items:[],baseActions:[],canUseGrid:!1,jumplist:[]};if("itunes"==d){if(b&&b.results){d=0;b=b.results;for(var l=b.length;d<l;++d)e.items.push({title:b[d].trackName,id:b[d].feedUrl,image:b[d].artworkUrl100,menu:[ADD_PODCAST_ACTION,MORE_ACTION],isPodcast:!0})}e.subtitle=i18np("1 Podcast","%1 Podcasts",e.items.length)}else if("gpodder"==d){if(b)for(d=0,l=b.length;d<l;++d)b[d].url.startsWith("http://www.striglsmusicnews.com")||e.items.push({title:b[d].title,id:b[d].url,
image:b[d].scaled_logo_url,descr:b[d].description,menu:[ADD_PODCAST_ACTION,MORE_ACTION],isPodcast:!0});e.subtitle=i18np("1 Podcast","%1 Podcasts",e.items.length)}0==e.items.length&&e.items.push({title:i18n("Empty"),type:"text",id:"empty"});return e};
