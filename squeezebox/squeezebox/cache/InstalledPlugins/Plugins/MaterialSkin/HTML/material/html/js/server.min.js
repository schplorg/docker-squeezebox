var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(m){g(m)}}:
b}var d,g,f=new e(function(a,b){d=a;g=b});this.callWhenSettled_(c(a,d),c(b,g));return f};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var k=$jscomp.makeIterator(a),e=k.next();!e.done;e=k.next())c(e.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function k(b){return function(c){f[b]=c;g--;0==g&&a(f)}}var f=[],g=0;do f.push(void 0),g++,c(d.value).callWhenSettled_(k(f.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b;})})}},"es9","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(d);if(!d.done)return this.context_.stop_(),d;var e=d.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a.throw(b)}return new Promise(function(d,e){function f(a){a.done?d(a.value):Promise.resolve(a.value).then(b,c).then(f,e)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(p){return!1}}function c(){}function d(a){if(!$jscomp.owns(a,f)){var b=new c;$jscomp.defineProperty(a,f,{value:b})}}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++h,c.set(b,d)):d="p_"+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return c},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var e=a.length;0<e&&0<c;)if(b[--c]!=a[--e])return!1;return 0>=e}},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,c,d){c=null!=c?c:function(a){return a};var b=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var g=0;!(f=a.next()).done;)b.push(c.call(d,f.value,g++))}else for(f=a.length,g=0;g<f;g++)b.push(c.call(d,a[g],g));return b}},"es6","es3");
var PLAYER_STATUS_TAGS="tags:cdegloyrstABKNS",lmsOptions={noGenreFilter:getLocalStorageBool("noGenreFilter",!1),noRoleFilter:getLocalStorageBool("noRoleFilter",!1)};function getHiddenProp(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0,c=a.length;b<c;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}var lastTime=(new Date).getTime();setInterval(function(){var a=(new Date).getTime();a>lastTime+4E3&&bus.$emit("refreshStatus");lastTime=a},2E3);
var lmsFavorites=new Set,lmsLastScan=void 0,haveLocalAndroidPlayer=!1,currentIpAddress=void 0;
if(isAndroid())try{var RTCPeerConnection=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;RTCPeerConnection&&function(){function a(a){var b=/(192\.168\.(0|\d{0,3})\.(0|\d{0,3}))/i;a.split("\r\n").forEach(function(a){a.match(b)&&(currentIpAddress=a.match(b)[0])})}var b=new RTCPeerConnection({iceServers:[]});b.createDataChannel("",{reliable:!1});b.onicecandidate=function(b){b.candidate&&a(b.candidate.candidate)};b.createOffer(function(a){b.setLocalDescription(a)},
function(a){console.warn("Failed to get IP address",a)})}()}catch(a){}function isHidden(){var a=getHiddenProp();return a?document[a]:!1}var lmsIsConnected=void 0,lmsConnectionCheckDelay=void 0,lmsLastFocusOrVisibilityChange=void 0;
function visibilityOrFocusChanged(){lmsLastFocusOrVisibilityChange=(new Date).getTime();if(document.hasFocus()||!isHidden())lmsIsConnected?IS_MOBILE&&bus.$emit("refreshStatus"):(void 0!=lmsConnectionCheckDelay&&clearTimeout(lmsConnectionCheckDelay),lmsConnectionCheckDelay=setTimeout(function(){lmsConnectionCheckDelay=void 0;lmsIsConnected||bus.$emit("reconnect")},250))}var lmsListSource=void 0,lmsListId=0;
function lmsCommand(a,b,c){c=c&&0<b.length&&"libraries"!=b[0]&&"favorites"!=b[0]||!c&&1<b.length&&("menu"==b[0]||"items"==b[1]);a={id:1,method:"slim.request",params:[a,b]};logJsonMessage("REQ",a.params);return c?(lmsListSource=axios.CancelToken.source(),lmsListId++,axios.post("/jsonrpc.js?id="+lmsListId,a,{cancelToken:lmsListSource.token}).finally(function(){lmsListSource=void 0})):axios.post("/jsonrpc.js",a)}
function lmsListFragment(a,b,c,d,e,f,g){var h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){h=b.slice();h=[].concat(h,[d,e]);c&&0<c.length&&(h=[].concat(h,c));return k.return(lmsCommand(a,h).then(function(h){h=h.data;logJsonMessage("RESP",h);return h&&h.result&&h.result.item_loop?(void 0==g?g=h:g.result.item_loop.push.apply(g.result.item_loop,h.result.item_loop),g.result.item_loop.length>=h.result.count?new Promise(function(a,b){a({data:g})}):lmsListFragment(a,b,c,d+e,e,f,g)):new Promise(function(a,
b){a({data:g})})}))})}
function lmsList(a,b,c,d,e,f){var g,h;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){g=void 0===e?LMS_BATCH_SIZE:e;if(1<b.length&&"custombrowse"==b[0]&&("browsejive"==b[1]||"browse"==b[1])&&999<g)return k.return(lmsListFragment(a,b,c,0,999,g));h=b.slice();h=[].concat(h,[void 0==d?0:d,g]);c&&0<c.length&&(h=[].concat(h,c));return f&&canUseCache?k.return(idbKeyval.get(cacheKey(b,c,d,e)).then(function(b){return void 0==b?lmsCommand(a,h):new Promise(function(a,c){a({data:b})})})):k.return(lmsCommand(a,
h,!0))})}
var lmsServer=Vue.component("lms-server",{template:"<div/>",data:function(){return{}},methods:{removeFromQueue:function(a){var b=this;if(0<a.length){var c=a.shift();lmsCommand(this.$store.state.player.id,["playlist","delete",c]).then(function(c){0<a.length&&b.removeFromQueue(a)})}else this.updateCurrentPlayer()},moveQueueItems:function(a,b,c,d){var e=this;if(0<a.length){var f=a.shift(),g=["playlist","move",f<b?f-c:f,f>b?b+d+(0<c?1:0):b];lmsCommand(this.$store.state.player.id,g).then(function(g){e.moveQueueItems(a,b,
f<b?c+1:c,f>b?d+1:d)}).catch(function(a){logError(a,g);e.updateCurrentPlayer()})}else this.updateCurrentPlayer()},movePlaylistItems:function(a,b,c,d,e){var f=this;if(0<b.length){var g=b.shift(),h=["playlists","edit","cmd:move",a,"index:"+(g<c?g-d:g),"toindex:"+(g>c?c+e+(0<d?1:0):c)];lmsCommand(this.$store.state.player.id,h).then(function(h){f.movePlaylistItems(a,b,c,g<c?d+1:d,g>c?e+1:e)}).catch(function(a){logError(a,h);bus.$emit("refreshList",SECTION_PLAYLISTS)})}else bus.$emit("refreshList",SECTION_PLAYLISTS)},
doAllList:function(a,b,c){var d=this;if(0<a.length){var e=a.shift(),f=b.slice();f.push(e);lmsCommand(this.$store.state.player.id,f).then(function(e){0<a.length?d.doAllList(a,b,c):bus.$emit("refreshList",c)}).catch(function(a){bus.$emit("refreshList",c)})}},scheduleNextPlayerStatusUpdate:function(a){this.cancelPlayerStatusTimer();a&&(logCometdDebug("Schedule next player poll in: "+a+"ms"),this.playerStatusTimer=setTimeout(function(){this.updateCurrentPlayer()}.bind(this),250>a?250:a))},reConnectToCometD:function(){!lmsIsConnected&&
this.cometd&&this.cometd.connectNow()},connectToCometD:function(){var a=this;lmsIsConnected=void 0;this.subscribedPlayers=new Set;logCometdDebug("CONNECT");this.cometd=new org.cometd.CometD;this.cometd.setMaxBackoff(1E4);this.cometd.init({url:"/cometd",logLevel:"off"});this.cometd.addListener("/meta/connect",function(b){b=eval(b).successful;b!=lmsIsConnected&&((lmsIsConnected=b)?(a.refreshServerStatus(),a.scheduleNextPlayerStatusUpdate(500),bus.$emit("networkStatus",lmsIsConnected)):(a.cancelConnectionFailureTimer(),
a.connectionFailureTimer=setTimeout(function(){this.connectionFailureTimer=void 0;bus.$emit("networkStatus",lmsIsConnected)}.bind(a),2E3)))});this.cometd.addListener("/meta/handshake",function(b){eval(b).successful&&(logCometdDebug("ADD_SUBSCRIPTIONS"),a.subscribedPlayers=new Set,a.cometd.subscribe("/"+a.cometd.getClientId()+"/**",function(b){a.handleCometDMessage(b)}),a.cometd.subscribe("/slim/subscribe",function(a){},{data:{response:"/"+a.cometd.getClientId()+"/slim/serverstatus",request:["",["serverstatus",
0,LMS_MAX_PLAYERS,"subscribe:60"]]}}),a.cometd.subscribe("/slim/subscribe",function(a){},{data:{response:"/"+a.cometd.getClientId()+"/slim/favorites",request:["favorites",["changed"]]}}),a.updateFavorites())})},handleCometDMessage:function(a){a.channel&&a.data&&(a.channel.endsWith("/slim/serverstatus")?this.handleServerStatus(a.data):0<a.channel.indexOf("/slim/playerstatus/")?this.handlePlayerStatus(a.channel.split("/").pop(),a.data):a.channel.endsWith("/slim/favorites")?a.data&&1<a.data.length&&
"favorites"==a.data[0]&&"changed"==a.data[1]&&this.handleFavoritesUpdate():0<a.channel.indexOf("/slim/playerprefs/")?this.handlePlayerPrefs(a.channel.split("/").pop(),a.data):logCometdDebug("ERROR: Unexpected channel:"+a.channel))},handleServerStatus:function(a){logCometdMessage("SERVER",a);var b=[],c=[];lmsLastScan!=a.lastscan&&(lmsLastScan=a.lastscan,clearListCache());if(a.players_loop){for(var d=!1,e=new Set,f=0,g=a.players_loop.length;f<g;++f){var h=a.players_loop[f];1==parseInt(h.connected)&&
(b.push({id:h.playerid,name:h.name,canpoweroff:1==parseInt(h.canpoweroff),ison:void 0==h.power||1==parseInt(h.power),isgroup:"group"===h.model}),!d&&currentIpAddress&&"SB Player"===h.modelname&&h.ip.split(":")[0]==currentIpAddress&&(d=!0),e.add(h.playerid))}if(a.other_players_loop)for(f=0,g=a.other_players_loop.length;f<g;++f)h=a.other_players_loop[f],e.has(h.playerid)||c.push({id:h.playerid,name:h.name,server:h.server,serverurl:h.serverurl});d!=haveLocalAndroidPlayer&&(haveLocalAndroidPlayer=d)&&
bus.$emit("haveLocalAndroidPlayer");this.$store.commit("setPlayers",b.sort(playerSort));this.$store.commit("setOtherPlayers",c.sort(otherPlayerSort));if(0==this.subscribedPlayers.size)if(this.subscribeAll)for(h=0,g=b.length;h<g;++h)this.subscribe(b[h].id);else this.$store.state.player&&this.$store.state.player.id&&this.subscribe(this.$store.state.player.id)}return c},handlePlayerStatus:function(a,b,c){c?logJsonMessage("PLAYER ("+a+")",b):logCometdMessage("PLAYER ("+a+")",b);if(this.subscribedPlayers.has(a)){c=
this.$store.state.player&&a==this.$store.state.player.id;var d={ison:void 0==b.power||1==parseInt(b.power),isplaying:"play"===b.mode&&!b.waitingToPlay,volume:-1,playlist:{shuffle:0,repeat:0,duration:0,name:"",current:-1,count:0,timestamp:0},current:{canseek:0,time:void 0,duration:void 0},will_sleep_in:b.will_sleep_in,synced:b.sync_master||b.sync_slaves,issyncmaster:b.sync_master==a,syncmaster:b.sync_master,syncslaves:b.sync_slaves?b.sync_slaves.split(","):[],id:a,name:b.player_name};if(c)d.isgroup=
this.$store.state.player.isgroup,this.isPlaying=d.isplaying;else for(var e=0,f=this.$store.state.players.length;e<f;++e)this.$store.state.players[e].id==a&&(d.isgroup=this.$store.state.players[e].isgroup);d.volume=void 0==b["mixer volume"]?0:Math.round(parseFloat(b["mixer volume"]));c&&(this.volume=d.volume);d.playlist={shuffle:parseInt(b["playlist shuffle"]),repeat:parseInt(b["playlist repeat"]),duration:void 0==b["playlist duration"]?void 0:parseFloat(b["playlist duration"]),name:b.playlist_name,
current:void 0==b.playlist_cur_index?-1:parseInt(b.playlist_cur_index),count:void 0==b.playlist_tracks?0:parseInt(b.playlist_tracks),timestamp:void 0===b.playlist_timestamp?0:parseFloat(b.playlist_timestamp)};b.playlist_loop&&0<b.playlist_loop.length&&(d.current=b.playlist_loop[0],d.current.time=void 0==b.time?void 0:"stop"==b.mode?0:parseFloat(b.time),d.current.canseek=parseInt(b.can_seek),d.current.remote_title=checkRemoteTitle(d.current),b.duration&&(d.current.duration=parseFloat(b.duration)),
void 0!=d.current.rating&&(d.current.rating=parseInt(d.current.rating),0>d.current.rating?d.current.rating=0:100<d.current.rating&&(d.current.rating=100)));bus.$emit(c?"playerStatus":"otherPlayerStatus",d);c&&this.scheduleNextPlayerStatusUpdate("play"===b.mode?b.waitingToPlay?1E3:void 0!=d.current.duration&&0!=d.current.duration?void 0!=d.current.time?2.5>d.current.duration-d.current.time?500:1E3*(d.current.duration-(d.current.time+2)):5>d.current.time?1E3:void 0:void 0:void 0)}},handlePlayerPrefs:function(a,
b){4>b.length||"prefset"!=b[0]||!this.$store.state.player||a!=this.$store.state.player.id||(logCometdMessage("PLAYERPREFS ("+a+")",b),"plugin.dontstopthemusic"==b[1]&&"provider"==b[2]&&bus.$emit("prefset",b[1]+":"+b[2],b[3]))},getPlayerPrefs:function(){bus.$emit("prefset","plugin.dontstopthemusic:provider",0);this.$store.state.dstmPlugin&&lmsCommand(this.$store.state.player.id,["playerpref","plugin.dontstopthemusic:provider","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&bus.$emit("prefset",
"plugin.dontstopthemusic:provider",a.result._p2)})},handleFavoritesUpdate:function(){logCometdDebug("FAVORITES");this.cancelFavoritesTimer();this.favoritesTimer=setTimeout(function(){this.updateFavorites()}.bind(this),500)},updateFavorites:function(){lmsCommand("",["material-skin","favorites"]).then(function(a){if((a=a.data)&&a.result&&a.result.favs_loop){a=a.result.favs_loop;for(var b=new Set,c=!1,d=0,e=a.length;d<e;++d)if(a[d].url){var f=a[d].url,g=f.indexOf("libraryTracks.library=");0<g&&(f=f.substring(0,
g-1));b.add(f);c||lmsFavorites.has(f)||(c=!0)}if(c||lmsFavorites.size!=b.size)lmsFavorites=b,bus.$emit("refreshList",SECTION_FAVORITES)}}).catch(function(a){})},updatePlayer:function(a){var b=this;logJsonMessage("UPDATING ("+a+")");lmsCommand(a,["status","-",1,PLAYER_STATUS_TAGS+(this.$store.state.ratingsSupport?"R":"")]).then(function(c){(c=c.data)&&c.result&&b.handlePlayerStatus(a,c.result,!0)})},updateCurrentPlayer:function(){this.$store.state.player&&this.updatePlayer(this.$store.state.player.id)},
subscribe:function(a){this.subscribedPlayers.has(a)||(logCometdDebug("Subscribe: "+a),this.cometd.subscribe("/slim/subscribe",function(a){},{data:{response:"/"+this.cometd.getClientId()+"/slim/playerstatus/"+a,request:[a,["status","-",1,PLAYER_STATUS_TAGS+(this.$store.state.ratingsSupport?"R":""),"subscribe:30"]]}}),this.cometd.subscribe("/slim/subscribe",function(a){},{data:{response:"/"+this.cometd.getClientId()+"/slim/playerprefs/"+a,request:[a,["prefset"]]}}),this.subscribedPlayers.add(a))},unsubscribe:function(a){this.subscribedPlayers.has(a)&&
(logCometdDebug("Unsubscribe: "+a),this.cometd.subscribe("/slim/subscribe",function(a){},{data:{response:"/"+this.cometd.getClientId()+"/slim/playerstatus/"+a,request:[a,["status","-",1,"subscribe:-"]]}}),this.subscribedPlayers.delete(a))},playerChanged:function(){if(this.$store.state.player&&!this.subscribedPlayers.has(this.$store.state.player.id)){if(!this.subscribeAll)for(var a=Array.from(this.subscribedPlayers),b=0,c=a.length;b<c;++b)this.unsubscribe(a[b]);this.subscribe(this.$store.state.player.id)}else this.updateCurrentPlayer();
this.getPlayerPrefs()},refreshServerStatus:function(){var a=this;lmsCommand("",["serverstatus",0,LMS_MAX_PLAYERS]).then(function(b){(b=b.data)&&b.result&&a.handleServerStatus(b.result)})},checkForMovedPlayer:function(a,b){var c=this;lmsCommand("",["serverstatus",0,LMS_MAX_PLAYERS]).then(function(d){if((d=d.data)&&d.result){d=c.handleServerStatus(d.result);for(var e=!1,f=0,g=d.length;f<g&&!e;++f)d[f].id==a&&(e=!0);b--;e?0<=b&&(c.moveTimer=setTimeout(function(){this.checkForMovedPlayer(a,b)}.bind(c),
500)):c.$store.commit("setPlayer",a)}})},cancelConnectionFailureTimer:function(){void 0!==this.connectionFailureTimer&&(clearTimeout(this.connectionFailureTimer),this.connectionFailureTimer=void 0)},cancelPlayerStatusTimer:function(){void 0!==this.playerStatusTimer&&(clearTimeout(this.playerStatusTimer),this.playerStatusTimer=void 0)},cancelFavoritesTimer:function(){void 0!==this.favoritesTimer&&(clearTimeout(this.favoritesTimer),this.favoritesTimer=void 0)},cancelMoveTimer:function(){void 0!==this.moveTimer&&
(clearTimeout(this.moveTimer),this.moveTimer=void 0)},checkPluginUpdates:function(){var a=this;axios.get(location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/updateinfo.json?s=time"+(new Date).getTime()).then(function(b){b=eval(b.data);a.$store.commit("setPluginUpdatesAvailable",b&&b.plugins&&0<b.plugins.length)}).catch(function(a){logError(a)})},cancelUpdatesTimer:function(){void 0!==this.updatesTimer&&(clearInterval(this.updatesTimer),this.updatesTimer=void 0)},startUpdatesTimer:function(){this.cancelUpdatesTimer();
setTimeout(function(){this.checkPluginUpdates();this.updatesTimer=setInterval(function(){this.checkPluginUpdates()}.bind(this),18E5)}.bind(this),500)},adjustVolume:function(a,b){var c=this;if(this.$store.state.player){void 0==b&&(b=1);for(var d=this.volume,e=0;e<b;++e)d=adjustVolume(d,a);lmsCommand(this.$store.state.player.id,["mixer","volume",d]).then(function(a){c.updateCurrentPlayer()})}}},created:function(){this.subscribeAll=!1;this.connectToCometD()},mounted:function(){this.moving=[];bus.$on("reconnect",
function(){this.reConnectToCometD()}.bind(this));bus.$on("refreshStatus",function(a){(a=a?a:this.$store.state.player?this.$store.state.player.id:void 0)&&this.updatePlayer(a)}.bind(this));bus.$on("refreshServerStatus",function(a){this.refreshServerStatus();void 0!=a&&50<a&&1E4>a&&setTimeout(function(){this.refreshServerStatus()}.bind(this),a)}.bind(this));bus.$on("refreshFavorites",function(){this.updateFavorites()}.bind(this));bus.$on("playerCommand",function(a){var b=this;this.$store.state.player&&
lmsCommand(this.$store.state.player.id,a).then(function(a){b.updateCurrentPlayer()})}.bind(this));bus.$on("updatePlayer",function(a){this.updatePlayer(a)}.bind(this));bus.$on("removeFromQueue",function(a){this.$store.state.player&&this.removeFromQueue(a)}.bind(this));bus.$on("moveQueueItems",function(a,c){this.$store.state.player&&this.moveQueueItems(a,c,0,0)}.bind(this));bus.$on("movePlaylistItems",function(a,c,d){this.movePlaylistItems(a,c,d,0,0)}.bind(this));bus.$on("doAllList",function(a,c,d){this.$store.state.player&&
this.doAllList(a,c,d)}.bind(this));bus.$on("movePlayer",function(a){var b=this;lmsCommand("",["material-skin","moveplayer","id:"+a.id,"serverurl:"+a.serverurl]).then(function(c){b.checkForMovedPlayer(a.id,8)}).catch(function(b){bus.$emit("showError",void 0,i18n("Failed to move '%1'",a.name))})}.bind(this));bus.$on("power",function(a){var b=this;lmsCommand(this.$store.state.player.id,["power",a]).then(function(a){b.updateCurrentPlayer()})}.bind(this));bus.$on("adjustVolume",function(a,c){this.adjustVolume(a,
c)}.bind(this));bus.$on("subscribeAll",function(a){if(a!=this.subscribeAll){(this.subscribeAll=a)&&this.updateCurrentPlayer();for(var b=0,d=this.$store.state.players.length;b<d;++b)a&&this.$store.state.players[b].id!=this.$store.state.player.id?this.subscribe(this.$store.state.players[b].id):a||this.$store.state.players[b].id==this.$store.state.player.id||this.unsubscribe(this.$store.state.players[b].id)}}.bind(this));bus.$on("playersRemoved",function(a){if(this.subscribeAll)for(var b=0,d=a.length;b<
d;++b)this.unsubscribe(a[b])}.bind(this));bus.$on("playersAdded",function(a){if(this.subscribeAll)for(var b=0,d=a.length;b<d;++b)this.subscribe(a[b])}.bind(this));var a=getHiddenProp();a&&document.addEventListener(a.replace(/[H|h]idden/,"")+"visibilitychange",visibilityOrFocusChanged);window.addEventListener("focus",visibilityOrFocusChanged);IS_MOBILE||(bindKey("up"),bindKey("down"),bindKey("space"),bindKey("left"),bindKey("right"),bus.$on("keyboard",function(a){var b=this;if(!(!this.$store.state.keyboardControl||
!this.$store.state.player||0<this.$store.state.visibleMenus.size||0<this.$store.state.openDialogs.length&&"info-dialog"!=this.$store.state.openDialogs[0])){var d=void 0;"up"==a?this.adjustVolume(!0):"down"==a?this.adjustVolume(!1):"left"==a?d=["button","jump_rew"]:"right"==a?d=["playlist","index","+1"]:"space"==a&&(d=[this.isPlaying?"pause":"play"]);d&&lmsCommand(this.$store.state.player.id,d).then(function(a){b.updateCurrentPlayer()})}}.bind(this)))},beforeDestroy:function(){this.cancelConnectionFailureTimer();
this.cancelPlayerStatusTimer();this.cancelFavoritesTimer();this.cancelMoveTimer();this.cancelUpdatesTimer()},watch:{"$store.state.player":function(a){bus.$emit("playerChanged");this.playerChanged()}}});
