var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(b,a,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("String.prototype.repeat",function(b){return b?b:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(a,b){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=c.length,f=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var g=0;g<f&&b<e;)if(c[b++]!=a[g++])return!1;return g>=f}},"es6","es3");
var BIO_TAB=0,REVIEW_TAB=1,LYRICS_TAB=2,lmsNowPlaying=Vue.component("lms-now-playing",{template:'\n<div>\n <v-tooltip v-if="!IS_MOBILE" top :position-x="timeTooltip.x" :position-y="timeTooltip.y" v-model="timeTooltip.show">{{timeTooltip.text}}</v-tooltip>\n <v-menu v-if="!mini && !nowplaying" v-model="menu.show" :position-x="menu.x" :position-y="menu.y" absolute offset-y>\n  <v-list>\n   <v-list-tile @click="showPic()">\n    <v-list-tile-avatar v-if="menuIcons" :tile="true" class="lms-avatar"><v-icon>photo</v-icon></v-list-tile-avatar>\n    <v-list-tile-title>{{menu.text[0]}}</v-list-tile-title>\n   </v-list-tile>\n   <v-list-tile @click="trackInfo()">\n    <v-list-tile-avatar v-if="menuIcons" :tile="true" class="lms-avatar"><img class="svg-img" :src="\'more\' | svgIcon(darkUi)"></img></v-list-tile-avatar>\n    <v-list-tile-title>{{menu.text[1]}}</v-list-tile-title>\n   </v-list-tile>\n  </v-list>\n </v-menu>\n<div v-if="desktop && !largeView && !nowplaying" class="np-bar noselect" id="np-bar">\n <v-layout row class="np-controls-desktop" v-if="stopButton">\n  <v-flex xs3>\n   <v-btn flat icon v-bind:class="{\'disabled\':disablePrev}" @click="if (!disablePrev) doAction([\'button\', \'jump_rew\'])"><v-icon large>skip_previous</v-icon></v-btn>\n  </v-flex>\n  <v-flex xs3>\n   <v-btn flat icon v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseA"><v-icon large v-if="playerStatus.isplaying">pause</v-icon><v-icon large v-else>play_arrow</v-icon></v-btn>\n  </v-flex>\n  <v-flex xs3>\n   <v-btn flat icon @click="doAction([\'stop\'])"><v-icon large>stop</v-icon></v-btn>\n  </v-flex>\n  <v-flex xs3>\n   <v-btn flat icon v-bind:class="{\'disabled\':disableNext}" @click="if (!disableNext) doAction([\'playlist\', \'index\', \'+1\'])"><v-icon large>skip_next</v-icon></v-btn>\n  </v-flex>\n </v-layout>\n <v-layout row class="np-controls-desktop" v-else>\n  <v-flex xs4>\n   <v-btn flat icon v-bind:class="{\'disabled\':disablePrev}" @click="if (!disablePrev) doAction([\'button\', \'jump_rew\'])" class="np-std-button"><v-icon large>skip_previous</v-icon></v-btn>\n  </v-flex>\n  <v-flex xs4>\n   <v-btn flat icon v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseB" class="np-playpause"><v-icon x-large>{{ playerStatus.isplaying ? \'pause_circle_outline\' : \'play_circle_outline\'}}</v-icon></v-btn>\n  </v-flex>\n  <v-flex xs4>\n   <v-btn flat icon v-bind:class="{\'disabled\':disableNext}" @click="if (!disableNext) doAction([\'playlist\', \'index\', \'+1\'])" class="np-std-button" ><v-icon large>skip_next</v-icon></v-btn>\n  </v-flex>\n </v-layout>\n <img :key="coverUrl" v-lazy="coverUrl" class="np-image-desktop" v-bind:class="{\'radio-img\': 0==playerStatus.current.duration}" @contextmenu="showContextMenu" @click="clickImage(event)"></img>\n <v-list two-line subheader class="np-details-desktop" v-bind:class="{\'np-details-desktop-sb\' : stopButton}">\n  <v-list-tile style>\n   <v-list-tile-content>\n    <v-list-tile-title v-if="playerStatus.current.title">{{playerStatus.current.title}}</v-list-tile-title>\n    <v-list-tile-sub-title v-if="playerStatus.current.artistAndComposer && playerStatus.current.album">{{playerStatus.current.artistAndComposer}}{{SEPARATOR}}{{playerStatus.current.album}}</v-list-tile-sub-title>\n    <v-list-tile-sub-title v-else-if="playerStatus.current.artistAndComposer && playerStatus.current.remote_title && playerStatus.current.remote_title!=playerStatus.current.title">{{playerStatus.current.artistAndComposer}}{{SEPARATOR}}{{playerStatus.current.remote_title}}</v-list-tile-sub-title>\n    <v-list-tile-sub-title v-else-if="playerStatus.current.artistAndComposer">{{playerStatus.current.artistAndComposer}}</v-list-tile-sub-title>\n    <v-list-tile-sub-title v-else-if="playerStatus.current.album">{{playerStatus.current.album}}</v-list-tile-sub-title>\n    <v-list-tile-sub-title v-else-if="playerStatus.current.remote_title && playerStatus.current.remote_title!=playerStatus.current.title">{{playerStatus.current.remote_title}}</v-list-tile-sub-title>\n    <v-list-tile-sub-title v-else-if="playerStatus.current.title">&#x22ef;</v-list-tile-sub-title>\n\n   </v-list-tile-content>\n   <v-list-tile-action>\n    <div v-if="(techInfo || ratingsSupported) && wide>0"><div class="np-tech-desktop">{{techInfo && (wide>1 || (!showRatings && wide>0)) ? playerStatus.current.technicalInfo : ""}}</div><v-rating v-if="showRatings && (landscape && wide>0)" class="np-rating-desktop" small v-model="rating.value" half-increments hover clearable @click.native="setRating"></v-rating></div>\n    <div v-else-if="playerStatus.playlist.count>1" class="np-tech-desktop" @click="toggleTime()">{{formattedTime}}</div>\n    <div v-else class="np-tech-desktop">&nbsp;</div>\n    <div v-if="((techInfo || ratingsSupported) && wide>0) || playerStatus.playlist.count<2" class="np-time-desktop" @click="toggleTime()">{{formattedTime}}{{playerStatus.playlist.current | trackCount(playerStatus.playlist.count, SEPARATOR)}}</div>\n    <div v-else class="np-time-desktop" @click="toggleTime()">{{playerStatus.playlist.current | trackCount(playerStatus.playlist.count)}}</div>\n   </v-list-tile-action>\n  </v-list-tile>\n </v-list>\n <v-progress-linear height="5" background-color="white" background-opacity="0.15" id="pos-slider" v-if="darkUi && playerStatus.current.duration>0" class="np-slider np-slider-desktop" v-bind:class="{\'np-slider-desktop-sb\' : stopButton}" :value="playerStatus.current.pospc" v-on:click="sliderChanged($event)" @mouseover="timeTooltip.show = true" @mouseout="timeTooltip.show = false" @mousemove="moveTimeTooltip"></v-progress-linear>\n <v-progress-linear height="5" background-color="black" background-opacity="0.15" id="pos-slider" v-else-if="playerStatus.current.duration>0" class="np-slider np-slider-desktop" v-bind:class="{\'np-slider-desktop-sb\' : stopButton}" :value="playerStatus.current.pospc" v-on:click="sliderChanged($event)" @mouseover="timeTooltip.show = true" @mouseout="timeTooltip.show = false" @mousemove="moveTimeTooltip"></v-progress-linear>\n\n <div v-if="info.show" class="np-info np-info-desktop bgnd-cover np-info-cover" id="np-info">\n  <v-tabs centered v-model="info.tab" v-if="info.showTabs" style="np-info-tab-cover">\n   <template v-for="(tab, index) in info.tabs">\n    <v-tab :key="index">{{tab.title}}</v-tab>\n    <v-tab-item :key="index" transition="" reverse-transition=""> \x3c!-- background image causes glitches with transitions --\x3e\n     <v-card flat class="np-info-card-cover">\n      <v-card-text class="np-info-text-desktop" v-bind:class="{\'np-info-lyrics\': LYRICS_TAB==index}" v-html="tab.text"></v-card-text>\n     </v-card>\n    </v-tab-item>\n   </template>\n  </v-tabs>\n  <div v-else>\n   <v-layout row>\n    <template v-for="(tab, index) in info.tabs">\n     <v-flex xs4>\n      <v-card flat class="np-info-card-cover">\n       <v-card-title><p>{{tab.title}}</p></v-card-title>\n       <v-card-text class="np-info-text-full-desktop" v-bind:class="{\'np-info-lyrics\': LYRICS_TAB==index}" v-html="tab.text"></v-card-text>\n      </v-card>\n     </v-flex>\n    </template>\n   </v-layout>\n  </div>\n  <v-card class="np-info-card-cover">\n   <v-card-actions>\n    <v-spacer></v-spacer>\n    <v-btn flat icon v-if="info.showTabs" @click="info.showTabs=false" :title="trans.expand"><v-icon style="margin-right:-18px">chevron_right</v-icon><v-icon style="margin-left:-18px">chevron_left</v-icon></v-btn>\n    <v-btn flat icon v-else @click="info.showTabs=true" :title="trans.collapse"><v-icon style="margin-right:-18px">chevron_left</v-icon><v-icon style="margin-left:-18px">chevron_right</v-icon></v-btn>\n    <div style="width:32px"></div>\n    <v-btn flat icon v-if="info.sync" @click="info.sync = false" :title="trans.sync"><v-icon class="active-btn">link</v-icon></v-btn>\n    <v-btn flat icon v-else @click="info.sync = true" :title="trans.unsync"><v-icon class="dimmed">link_off</v-icon></v-btn>\n    <div style="width:32px"></div>\n    <v-btn flat icon @click="trackInfo()" :title="trans.more"><img class="svg-img" :src="\'more\' | svgIcon(darkUi)"></img></v-btn>\n    <div style="width:32px"></div>\n    <v-btn flat icon @click="info.show = false" :title="trans.close"><v-icon>close</v-icon></v-btn>\n    <v-spacer></v-spacer>\n   </v-card-actions>\n  </v-card>\n </div>\n</div>\n<div class="np-page bgnd-cover" v-else id="np-page">\n <div v-if="info.show" class="np-info bgnd-cover" id="np-info">\n  <v-tabs centered v-model="info.tab" class="np-info-tab-cover">\n   <template v-for="(tab, index) in info.tabs">\n    <v-tab :key="index">{{tab.title}}</v-tab>\n    <v-tab-item :key="index" transition="" reverse-transition=""> \x3c!-- background image causes glitches with transitions --\x3e\n     <v-card flat class="np-info-card-cover">\n      <v-card-text class="np-info-text" v-bind:class="{\'np-info-lyrics\': LYRICS_TAB==index}" v-html="tab.text"></v-card-text>\n     </v-card>\n    </v-tab-item>\n   </template>\n  </v-tabs>\n  <v-card class="np-info-card-cover">\n   <v-card-actions>\n    <v-spacer></v-spacer>\n    <v-btn flat icon v-if="info.sync" @click="info.sync = false" :title="trans.sync"><v-icon class="active-btn">link</v-icon></v-btn>\n    <v-btn flat icon v-else @click="info.sync = true" :title="trans.unsync"><v-icon class="dimmed">link_off</v-icon></v-btn>\n    <div style="width:32px"></div>\n    <v-btn flat icon @click="trackInfo()" :title="trans.more"><img class="svg-img" :src="\'more\' | svgIcon(darkUi)"></img></v-btn>\n    <div style="width:32px"></div>\n    <v-btn flat icon @click="info.show = false" :title="trans.close"><v-icon>close</v-icon></v-btn>\n    <v-spacer></v-spacer>\n   </v-card-actions>\n  </v-card>\n </div>\n <div v-else>\n  <div v-show="overlayVolume>-1" id="volumeOverlay">{{overlayVolume}}%</div>\n  <div v-if="landscape" v-touch:start="touchStart" v-touch:end="touchEnd" v-touch:moving="touchMoving">\n   <img v-if="!info.show" :key="coverUrl" v-lazy="coverUrl" class="np-image-landscape" v-bind:class="{\'np-image-landscape-wide\': landscape && wide>1}" @contextmenu="showMenu" @click="clickImage(event)"></img>\n   <div class="np-details-landscape">\n    <div class="np-text-landscape np-title" v-bind:class="{\'np-text-landscape-1\': lowHeight}" v-if="playerStatus.current.title">{{playerStatus.current.title | limitStr}}</div>\n    <div class="np-text-landscape" v-else>&nbsp;</div>\n    <div class="np-text-landscape subtext" v-bind:class="{\'np-text-landscape-1\': lowHeight}" v-if="playerStatus.current.artistAndComposer">{{playerStatus.current.artistAndComposer | limitStr}}</div>\n    <div class="np-text-landscape" v-else>&nbsp;</div>\n    <div class="np-text-landscape subtext" v-bind:class="{\'np-text-landscape-1\': lowHeight}" v-if="playerStatus.current.album">{{playerStatus.current.album | limitStr}}</div>\n    <div class="np-text-landscape subtext" v-bind:class="{\'np-text-landscape-1\': lowHeight}" v-else-if="playerStatus.current.remote_title && playerStatus.current.remote_title!=playerStatus.current.title">{{playerStatus.current.remote_title | limitStr}}</div>\n    <div class="np-text-landscape" v-else>&nbsp;</div>\n    <div v-if="showRatings && playerStatus.current.duration>0 && undefined!=rating.value" class="np-text-landscape">\n     <v-rating v-if="maxRating>5" v-model="rating.value" half-increments hover clearable @click.native="setRating"></v-rating>\n     <v-rating v-else v-model="rating.value" hover clearable @click.native="setRating"></v-rating>\n    </div>\n    <div v-if="wide>1">\n\n     <v-layout text-xs-center row wrap class="np-controls-wide">\n      <v-flex xs12 class="np-tech ellipsis" v-if="techInfo || playerStatus.playlist.count>1">{{techInfo ? playerStatus.current.technicalInfo : ""}}{{playerStatus.playlist.current | trackCount(playerStatus.playlist.count, techInfo ? SEPARATOR : undefined)}}</v-flex>\n      <v-flex xs12 v-if="!info.show && undefined!=playerStatus.current.time">\n       <v-layout class="np-time-layout">\n        <p class="np-pos" v-bind:class="{\'np-pos-center\': playerStatus.current.duration<=0}">{{playerStatus.current.time | displayTime}}</p>\n        <v-progress-linear height="5" background-color="black" background-opacity="0.15" v-if="playerStatus.current.duration>0" id="pos-slider" class="np-slider" :value="playerStatus.current.pospc" v-on:click="sliderChanged($event)" @mouseover="timeTooltip.show = true" @mouseout="timeTooltip.show = false" @mousemove="moveTimeTooltip"></v-progress-linear>\n        <p class="np-duration cursor" v-if="(showTotal || !playerStatus.current.time) && playerStatus.current.duration>0" @click="toggleTime()">{{playerStatus.current.duration | displayTime}}</p>\n        <p class="np-duration cursor" v-else-if="playerStatus.current.duration>0" @click="toggleTime()">-{{playerStatus.current.duration-playerStatus.current.time | displayTime}}</p>\n       </v-layout>\n      </v-flex>\n   <v-flex xs12 v-else-if="!info.show"><div style="height:31px"></div></v-flex>\n      <v-flex xs4>\n       <v-layout text-xs-center>\n        <v-flex xs6>\n         <v-btn v-if="repAltBtn.show" :title="repAltBtn.tooltip" flat icon @click="doCommand(repAltBtn.command, repAltBtn.tooltip)" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon v-if="repAltBtn.icon">{{repAltBtn.icon}}</v-icon><img v-else :src="repAltBtn.image" class="btn-img"></img></v-btn>\n         <v-btn :title="trans.repeatOne" flat icon v-else-if="playerStatus.playlist.repeat===1" @click="doAction([\'playlist\', \'repeat\', 0])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">repeat_one</v-icon></v-btn>\n         <v-btn :title="trans.repeatAll" flat icon v-else-if="playerStatus.playlist.repeat===2" @click="doAction([\'playlist\', \'repeat\', 1])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">repeat</v-icon></v-btn>\n         <v-btn :title="trans.dstm" flat icon v-else-if="dstm" @click="v" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">all_inclusive</v-icon></v-btn>\n         <v-btn :title="trans.repeatOff" flat icon v-else v-longpress="repeatOff" class="dimmed" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon>repeat</v-icon></v-btn>\n        </v-flex>\n        <v-flex xs6><v-btn flat icon @click="if (!disablePrev) doAction([\'button\', \'jump_rew\'])" v-bind:class="{\'np-std-button\': !stopButton, \'disabled\':disablePrev}"><v-icon large>skip_previous</v-icon></v-btn></v-flex>\n       </v-layout>\n      </v-flex>\n      <v-flex xs4>\n       <v-layout v-if="stopButton" text-xs-center>\n        <v-flex xs6>\n         <v-btn flat icon v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseC"><v-icon large v-if="playerStatus.isplaying">pause</v-icon><v-icon large v-else>play_arrow</v-icon></v-btn>\n        </v-flex>\n        <v-flex xs6>\n         <v-btn flat icon @click="doAction([\'stop\'])"><v-icon large>stop</v-icon></v-btn>\n        </v-flex>\n       </v-layout>\n       <v-btn flat icon large v-else v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseD" class="np-playpause"><v-icon x-large>{{ playerStatus.isplaying ? \'pause_circle_outline\' : \'play_circle_outline\'}}</v-icon></v-btn>\n      </v-flex>\n      <v-flex xs4>\n       <v-layout text-xs-center>\n        <v-flex xs6><v-btn flat icon @click="if (!disableNext) doAction([\'playlist\', \'index\', \'+1\'])" v-bind:class="{\'np-std-button\': !stopButton, \'disabled\':disableNext}"><v-icon large>skip_next</v-icon></v-btn></v-flex>\n        <v-flex xs6>\n         <v-btn v-if="shuffAltBtn.show" :title="shuffAltBtn.tooltip" flat icon @click="doCommand(shuffAltBtn.command, shuffAltBtn.tooltip)" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon v-if="shuffAltBtn.icon">{{shuffAltBtn.icon}}</v-icon><img v-else :src="shuffAltBtn.image" class="btn-img"></img></v-btn>\n         <v-btn :title="trans.shuffleAlbums" flat icon v-else-if="playerStatus.playlist.shuffle===2" @click="doAction([\'playlist\', \'shuffle\', 0])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="shuffle-albums active-btn"">shuffle</v-icon></v-btn>\n         <v-btn :title="trans.shuffleAll" flat icon v-else-if="playerStatus.playlist.shuffle===1" @click="doAction([\'playlist\', \'shuffle\', 2])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">shuffle</v-icon></v-btn>\n         <v-btn :title="trans.shuffleOff" flat icon v-else @click="doAction([\'playlist\', \'shuffle\', 1])" class="dimmed" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon>shuffle</v-icon></v-btn>\n        </v-flex>\n       </v-layout>\n      </v-flex>\n     </v-layout>\n\n    </div>\n   </div>\n  </div>\n  <div v-else v-touch:start="touchStart" v-touch:end="touchEnd" v-touch:moving="touchMoving">\n   <div v-bind:style="{height: portraitPad+\'px\'}"></div>\n   <p class="np-text np-title ellipsis" v-if="playerStatus.current.title">{{playerStatus.current.title}}</p>\n   <p class="np-text" v-else>&nbsp;</p>\n   <p class="np-text subtext ellipsis" v-if="playerStatus.current.artistAndComposer">{{playerStatus.current.artistAndComposer}}</p>\n   <p class="np-text" v-else>&nbsp;</p>\n   <p class="np-text subtext ellipsis" v-if="playerStatus.current.album">{{playerStatus.current.album}}</p>\n   <p class="np-text subtext ellipsis" v-else-if="playerStatus.current.remote_title && playerStatus.current.remote_title!=playerStatus.current.title">{{playerStatus.current.remote_title}}</p>\n   <p class="np-text" v-else>&nbsp;</p>\n   <img v-if="!info.show" :key="coverUrl" v-lazy="coverUrl" class="np-image" v-bind:class="{\'np-image-large\' : !(techInfo || playerStatus.playlist.count>1) && !showRatings}" @contextmenu="showMenu" @click="clickImage(event)" v-bind:style="{\'margin-top\': portraitImagePad+\'px\'}"></img>\n  </div>\n  <v-layout text-xs-center row wrap class="np-controls" v-if="!(landscape && wide>1)">\n   <v-flex xs12 v-if="showRatings && playerStatus.current.duration>0 && undefined!=rating.value && !landscape" class="np-text" v-bind:class="{\'np-rating-shadow\' : techInfo || playerStatus.playlist.count>1}">\n    <v-rating v-if="maxRating>5" v-model="rating.value" half-increments hover clearable @click.native="setRating"></v-rating>\n    <v-rating v-else v-model="rating.value" hover clearable @click.native="setRating"></v-rating>\n   </v-flex>\n   <v-flex xs12 class="np-tech ellipsis" v-if="techInfo || playerStatus.playlist.count>1">{{techInfo ? playerStatus.current.technicalInfo : ""}}{{playerStatus.playlist.current | trackCount(playerStatus.playlist.count, techInfo ? SEPARATOR : undefined)}}</v-flex>\n\n   <v-flex xs12 v-if="!info.show && undefined!=playerStatus.current.time">\n    <v-layout>\n     <p class="np-pos" v-bind:class="{\'np-pos-center\': playerStatus.current.duration<=0}">{{playerStatus.current.time | displayTime}}</p>\n     <v-progress-linear height="5" background-color="black" background-opacity="0.15" v-if="playerStatus.current.duration>0" id="pos-slider" class="np-slider" :value="playerStatus.current.pospc" v-on:click="sliderChanged($event)" @mouseover="timeTooltip.show = true" @mouseout="timeTooltip.show = false" @mousemove="moveTimeTooltip"></v-progress-linear>\n     <p class="np-duration cursor" v-if="(showTotal || !playerStatus.current.time) && playerStatus.current.duration>0" @click="toggleTime()">{{playerStatus.current.duration | displayTime}}</p>\n     <p class="np-duration cursor" v-else-if="playerStatus.current.duration>0" @click="toggleTime()">-{{playerStatus.current.duration-playerStatus.current.time | displayTime}}</p>\n    </v-layout>\n   </v-flex>\n   <v-flex xs12 v-else-if="!info.show"><div style="height:31px"></div></v-flex>\n\n   <v-flex xs4 class="no-control-adjust">\n    <v-layout text-xs-center>\n     <v-flex xs6>\n      <v-btn v-if="repAltBtn.show" :title="repAltBtn.tooltip" flat icon @click="doCommand(repAltBtn.command, repAltBtn.tooltip)" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon v-if="repAltBtn.icon">{{repAltBtn.icon}}</v-icon><img v-else :src="repAltBtn.image" class="btn-img"></img></v-btn>\n      <v-btn :title="trans.repeatOne" flat icon v-else-if="playerStatus.playlist.repeat===1" @click="doAction([\'playlist\', \'repeat\', 0])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">repeat_one</v-icon></v-btn>\n      <v-btn :title="trans.repeatAll" flat icon v-else-if="playerStatus.playlist.repeat===2" @click="doAction([\'playlist\', \'repeat\', 1])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">repeat</v-icon></v-btn>\n      <v-btn :title="trans.dstm" flat icon v-else-if="dstm" @click="bus.$emit(\'dlg.open\', \'dstm\')" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">all_inclusive</v-icon></v-btn>\n      <v-btn :title="trans.repeatOff" flat icon v-else v-longpress="repeatOff" class="dimmed" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon>repeat</v-icon></v-btn>\n     </v-flex>\n     <v-flex xs6><v-btn flat icon @click="if (!disablePrev) doAction([\'button\', \'jump_rew\'])" v-bind:class="{\'np-std-button\': !stopButton, \'disabled\':disablePrev}"><v-icon large>skip_previous</v-icon></v-btn></v-flex>\n    </v-layout>\n   </v-flex>\n   <v-flex xs4 class="no-control-adjust">\n    <v-layout v-if="stopButton" text-xs-center>\n     <v-flex xs6>\n      <v-btn flat icon v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseE"><v-icon large v-if="playerStatus.isplaying">pause</v-icon><v-icon large v-else>play_arrow</v-icon></v-btn>\n     </v-flex>\n     <v-flex xs6>\n      <v-btn flat icon @click="doAction([\'stop\'])"><v-icon large>stop</v-icon></v-btn>\n     </v-flex>\n    </v-layout>\n    <v-btn flat icon large v-else v-longpress="playPauseButton" @click.middle="showSleep" id="playPauseF" class="np-playpause"><v-icon x-large>{{ playerStatus.isplaying ? \'pause_circle_outline\' : \'play_circle_outline\'}}</v-icon></v-btn>\n   </v-flex>\n   <v-flex xs4 class="no-control-adjust">\n    <v-layout text-xs-center>\n     <v-flex xs6><v-btn flat icon @click="if (!disableNext) doAction([\'playlist\', \'index\', \'+1\'])" v-bind:class="{\'np-std-button\': !stopButton, \'disabled\':disableNext}"><v-icon large>skip_next</v-icon></v-btn></v-flex>\n     <v-flex xs6>\n      <v-btn v-if="shuffAltBtn.show" :title="shuffAltBtn.tooltip" flat icon @click="doCommand(shuffAltBtn.command, shuffAltBtn.tooltip)" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon v-if="shuffAltBtn.icon">{{shuffAltBtn.icon}}</v-icon><img v-else :src="shuffAltBtn.image" class="btn-img"></img></v-btn>\n      <v-btn :title="trans.shuffleAlbums" flat icon v-else-if="playerStatus.playlist.shuffle===2" @click="doAction([\'playlist\', \'shuffle\', 0])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="shuffle-albums active-btn"">shuffle</v-icon></v-btn>\n      <v-btn :title="trans.shuffleAll" flat icon v-else-if="playerStatus.playlist.shuffle===1" @click="doAction([\'playlist\', \'shuffle\', 2])" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon class="active-btn">shuffle</v-icon></v-btn>\n      <v-btn :title="trans.shuffleOff" flat icon v-else @click="doAction([\'playlist\', \'shuffle\', 1])" class="dimmed" v-bind:class="{\'np-std-button\': !stopButton}"><v-icon>shuffle</v-icon></v-btn>\n     </v-flex>\n    </v-layout>\n   </v-flex>\n  </v-layout>\n </div>\n</div></div>\n',props:["desktop",
"nowplaying","mini"],data:function(){return{coverUrl:LMS_BLANK_COVER,playerStatus:{isplaying:!1,sleepTimer:!1,current:{canseek:1,duration:0,time:void 0,title:void 0,artist:void 0,artistAndComposer:void 0,album:void 0,albumName:void 0,technicalInfo:"",pospc:0,tracknum:void 0},playlist:{shuffle:0,repeat:0,current:0,count:0}},info:{show:!1,tab:LYRICS_TAB,showTabs:!1,sync:!0,tabs:[{title:void 0,text:void 0},{title:void 0,text:void 0},{title:void 0,text:void 0}]},trans:{close:void 0,expand:void 0,collapse:void 0,
sync:void 0,unsync:void 0,more:void 0,dstm:void 0,repeatAll:void 0,repeatOne:void 0,repeatOff:void 0,shuffleAll:void 0,shuffleAlbums:void 0,shuffleOff:void 0},showTotal:!0,portraitPad:0,portraitImagePad:0,landscape:!1,wide:0,lowHeight:!1,largeView:!1,menu:{show:!1,x:0,y:0,text:["",""]},rating:{value:0,setting:!1},timeTooltip:{show:!1,x:0,y:0,text:void 0},overlayVolume:-1,repAltBtn:{show:!1,command:[],icon:void 0,image:void 0,tooltip:void 0},shuffAltBtn:{show:!1,command:[],icon:void 0,image:void 0,
tooltip:void 0},disablePrev:!1,disableNext:!1,dstm:!1}},mounted:function(){if(this.desktop)this.nowplaying?this.largeView=!0:(this.info.showTabs=getLocalStorageBool("showTabs",!1),bus.$on("largeView",function(a){a&&(this.info.show=!1);this.largeView=a}.bind(this)));else{bus.$on("pageChanged",function(a){var b=this;0==this.lastWidth&&"now-playing"==a&&this.$nextTick(function(){b.portraitElem=document.getElementById("np-page");b.lastWidth=b.portraitElem?b.portraitElem.offsetWidth:0;b.lastHeight=b.portraitElem?
b.portraitElem.offsetHeight:0;b.calcPortraitPad()})}.bind(this));this.lastWidth=(this.portraitElem=document.getElementById("np-page"))?this.portraitElem.offsetWidth:0;this.lastHeight=this.portraitElem?this.portraitElem.offsetHeight:0;this.lowHeight=window.innerHeight<=(this.desktop?400:450);this.calcPortraitPad();var b=this;window.addEventListener("resize",function(){b.resizeTimeout&&clearTimeout(b.resizeTimeout);b.resizeTimeout=setTimeout(function(){b.landscape||b.portraitElem||(b.portraitElem=document.getElementById("np-page"),
b.lastWidth=b.portraitElem?b.portraitElem.offsetWidth:0,b.lastHeight=b.portraitElem?b.portraitElem.offsetHeight:0);b.portraitElem&&(4<Math.abs(b.lastWidth-b.portraitElem.offsetWidth)||Math.abs(b.lastHeight-b.portraitElem.offsetHeight))&&(b.lastWidth=b.portraitElem.offsetWidth,b.lastHeight=b.portraitElem.offsetHeight,b.calcPortraitPad());b.lowHeight=window.innerHeight<=(b.desktop?400:430);b.resizeTimeout=void 0},50)},!1);bus.$on("nav",function(a,b){"now-playing"==a&&(b?this.playerStatus&&void 0!=this.playerStatus.current.id&&
this.trackInfo():this.$store.state.infoPlugin&&this.playerStatus&&this.playerStatus.current&&this.playerStatus.current.artist?(this.largeView=!1,this.info.show=!this.info.show):this.info.show&&(this.info.show=!1))}.bind(this))}this.info.sync=getLocalStorageBool("syncInfo",!0);bus.$on("playerStatus",function(a){var b=!1,d=!1;a.isplaying!=this.playerStatus.isplaying&&(this.playerStatus.isplaying=a.isplaying,b=!0);a.current.canseek!=this.playerStatus.current.canseek&&(this.playerStatus.current.canseek=
a.current.canseek);a.current.duration!=this.playerStatus.current.duration&&(this.playerStatus.current.duration=a.current.duration);if(a.current.time!=this.playerStatus.current.time||b)this.playerStatus.current.time=a.current.time,this.playerStatus.current.updated=new Date,this.playerStatus.current.origTime=a.current.time;this.setPosition();a.current.id!=this.playerStatus.current.id&&(this.playerStatus.current.id=a.current.id);a.current.title!=this.playerStatus.current.title&&(this.playerStatus.current.title=
a.current.title,d=!0);a.current.tracknum!=this.playerStatus.current.tracknum&&(this.playerStatus.current.tracknum=a.current.tracknum,d=!0);a.will_sleep_in!=this.playerStatus.sleepTimer&&(this.playerStatus.sleepTimer=a.will_sleep_in);var e=a.current.trackartist?a.current.trackartist:a.current.artist,f=a.current.trackartist_id?a.current.trackartist_id:a.current.artist_id,g=a.current.trackartist_ids?a.current.trackartist_ids:a.current.artist_ids;if(this.playerStatus.current.artist!=e||this.playerStatus.current.artist_id!=
f||this.playerStatus.current.artist_ids!=g)this.playerStatus.current.artist=e,this.playerStatus.current.artist_id=f,this.playerStatus.current.artist_ids=g,d=!0;if(a.current.albumartist!=this.playerStatus.current.albumartist||a.current.albumartist_ids!=this.playerStatus.current.albumartist_ids)this.playerStatus.current.albumartist=a.current.albumartist,this.playerStatus.current.albumartist_ids=a.current.albumartist_ids,d=!0;if(a.current.album!=this.playerStatus.current.albumName||a.current.album_id!=
this.playerStatus.current.album_id)this.playerStatus.current.albumName=a.current.album,this.playerStatus.current.album_id=a.current.album_id,this.playerStatus.current.album=a.current.year&&0<a.current.year?this.playerStatus.current.albumName+" ("+a.current.year+")":this.playerStatus.current.albumName,d=!0;a.current.remote_title!=this.playerStatus.current.remote_title&&(this.playerStatus.current.remote_title=a.current.remote_title,d=!0);a.current.rating!=this.rating.setting&&(this.rating.setting=a.current.rating,
this.rating.value=void 0==this.rating.setting?0:Math.ceil(this.rating.setting/10)/2,d=!0);e=a.current.composer&&a.current.genre&&LMS_COMPOSER_GENRES.has(a.current.genre)?addPart(a.current.composer,this.playerStatus.current.artist):this.playerStatus.current.artist;e!=this.playerStatus.current.artistAndComposer&&(this.playerStatus.current.artistAndComposer=e);a.playlist.shuffle!=this.playerStatus.playlist.shuffle&&(this.playerStatus.playlist.shuffle=a.playlist.shuffle);a.playlist.repeat!=this.playerStatus.playlist.repeat&&
(this.playerStatus.playlist.repeat=a.playlist.repeat);a.playlist.current!=this.playerStatus.playlist.current&&(this.playerStatus.playlist.current=a.playlist.current);a.playlist.count!=this.playerStatus.playlist.count&&(this.playerStatus.playlist.count=a.playlist.count);e=[];a.current.bitrate&&e.push(a.current.bitrate);a.current.type&&(f=a.current.type.indexOf(" ("),e.push(0<f?a.current.type.substring(0,f):a.current.type));e=e.join(SEPARATOR);e!=this.playerStatus.current.technicalInfo&&(this.playerStatus.current.technicalInfo=
e);d&&this.info.sync&&(this.setInfoTrack(),this.showInfo());b?this.playerStatus.isplaying?this.startPositionInterval():this.stopPositionInterval():this.playerStatus.isplaying&&d&&this.startPositionInterval();this.volume=0>a.volume?-1*a.volume:a.volume;b=(a=a.current.buttons)?a.shuffle:void 0;d=a?a.repeat:void 0;b&&b.command?this.shuffAltBtn={show:!0,command:b.command,tooltip:b.tooltip,image:b.icon,icon:"thumbsDown"==b.jiveStyle?"thumb_down":"thumbsUp"==b.jiveStyle?"thumb_up":void 0}:this.shuffAltBtn.show&&
(this.shuffAltBtn.show=!1);d&&d.command?this.repAltBtn={show:!0,command:d.command,tooltip:d.tooltip,image:d.icon,icon:"thumbsDown"==d.jiveStyle?"thumb_down":"thumbsUp"==d.jiveStyle?"thumb_up":void 0}:this.repAltBtn.show&&(this.repAltBtn.show=!1);this.disablePrev=a&&void 0!=a.rew&&0==parseInt(a.rew);this.disableNext=a&&void 0!=a.fwd&&0==parseInt(a.fwd)}.bind(this));bus.$emit("refreshStatus");this.page=document.getElementById("np-page");bus.$on("themeChanged",function(){this.setBgndCover()}.bind(this));
this.landscape=isLandscape();this.wide=900<=window.innerWidth?2:650<=window.innerWidth?1:0;setInterval(function(){this.landscape=isLandscape();this.wide=900<=window.innerWidth?2:650<=window.innerWidth?1:0}.bind(this),1E3);bus.$on("windowWidthChanged",function(){this.landscape=isLandscape();this.wide=900<=window.innerWidth?2:650<=window.innerWidth?1:0}.bind(this));bus.$on("currentCover",function(b){this.coverUrl=void 0==b?LMS_BLANK_COVER:b;this.setBgndCover()}.bind(this));bus.$emit("getCurrentCover");
bus.$on("langChanged",function(){this.initItems()}.bind(this));this.initItems();bus.$on("esc",function(){this.menu.show=!1}.bind(this));bus.$on("info",function(){this.largeView=!1;this.info.show=!this.info.show}.bind(this));bus.$on("prefset",function(b,c){"plugin.dontstopthemusic:provider"==b&&(this.dstm="0"!=""+c)}.bind(this));this.showTotal=getLocalStorageBool("showTotal",!0);IS_MOBILE||this.mini||this.nowplaying||(bindKey(LMS_TRACK_INFO_KEYBOARD,"mod"),this.desktop&&bindKey(LMS_EXPAND_NP_KEYBOARD,
"mod"),bus.$on("keyboard",function(b,c){!this.$store.state.keyboardControl||"mod"!=c||0<this.$store.state.visibleMenus.size||1<this.$store.state.openDialogs.length||!this.desktop&&"now-playing"!=this.$store.state.page||(LMS_TRACK_INFO_KEYBOARD!=b||!this.$store.state.infoPlugin||0!=this.$store.state.openDialogs.length&&"info-dialog"!=this.$store.state.openDialogs[0]?LMS_EXPAND_NP_KEYBOARD==b&&(this.info.show=!1,this.largeView=!this.largeView):(this.largeView=!1,this.info.show=!this.info.show))}.bind(this)))},
methods:{initItems:function(){this.trans={close:i18n("Close"),expand:i18n("Show all information"),collapse:i18n("Show information in tabs"),sync:i18n("Update information when song changes"),unsync:i18n("Don't update information when song changes"),more:i18n("More"),dstm:i18n("Don't Stop The Music"),repeatAll:i18n("Repeat queue"),repeatOne:i18n("Repeat single track"),repeatOff:i18n("No repeat"),shuffleAll:i18n("Shuffle tracks"),shuffleAlbums:i18n("Shuffle albums"),shuffleOff:i18n("No shuffle")};this.info.tabs[LYRICS_TAB].title=
i18n("Lyrics");this.info.tabs[BIO_TAB].title=i18n("Artist Biography");this.info.tabs[REVIEW_TAB].title=i18n("Album Review");this.menu.text[0]=i18n("Show image");this.menu.text[1]=i18n("Show track information")},calcPortraitPad:function(){if(!this.portraitElem||this.landscape)this.portraitPad=0;else{var b=Math.max(0,Math.floor((this.portraitElem.offsetHeight-(this.portraitElem.offsetWidth-32+(this.$store.state.ratingsSupport||this.$store.state.techInfo?120:90)+(this.$store.state.largeFonts?120:80)))/
2/2)-8);if(b!=this.portraitPad){this.portraitPad=b;var a=0;this.$store.state.largeFonts&&.69>this.portraitElem.offsetWidth/this.portraitElem.offsetHeight&&(a=16);this.portraitImagePad=-1*b-a}else this.$store.state.largeFonts&&(a=0,.69>this.portraitElem.offsetWidth/this.portraitElem.offsetHeight&&(a=16),b=-1*this.portraitPad-a,b!=this.portraitImagePad&&(this.portraitImagePad=b))}},showContextMenu:function(b){1>this.$store.state.visibleMenus.size?this.showMenu(b):b.preventDefault()},showMenu:function(b){var a=
this;b.preventDefault();this.clearClickTimeout();!this.coverUrl||this.coverUrl==LMS_BLANK_COVER||void 0!=this.touch&&this.touch.moving||(this.touch=void 0,this.menu.show=!1,this.menu.x=b.clientX,this.menu.y=b.clientY,this.$nextTick(function(){a.menu.show=!0}))},showPic:function(){var b=this;this.gallery=new PhotoSwipe(document.querySelectorAll(".pswp")[0],PhotoSwipeUI_Default,[{src:changeImageSizing(this.coverUrl),w:0,h:0}],{index:0});this.gallery.listen("gettingData",function(a,c){if(1>c.w||1>c.h)a=
new Image,a.onload=function(){c.w=this.width;c.h=this.height;b.gallery.updateSize(!0)},a.src=c.src});this.gallery.init();this.$store.commit("dialogOpen",{name:"np-viewer",shown:!0});this.gallery.listen("close",function(){bus.$emit("dialogOpen","np-viewer",!1)})},doAction:function(b){0<this.$store.state.visibleMenus.size||bus.$emit("playerCommand",b)},setPosition:function(){var b=this.playerStatus.current&&void 0!=this.playerStatus.current.time&&void 0!=this.playerStatus.current.duration&&0<this.playerStatus.current.duration?
100*Math.floor(1E3*this.playerStatus.current.time/this.playerStatus.current.duration)/1E3:0;b!=this.playerStatus.current.pospc&&(this.playerStatus.current.pospc=b)},sliderChanged:function(b){if(this.playerStatus.current.canseek&&3<this.playerStatus.current.duration){var a=document.getElementById("pos-slider").getBoundingClientRect();this.doAction(["time",Math.floor(this.playerStatus.current.duration*(b.clientX-a.x)/a.width)])}},moveTimeTooltip:function(b){if(this.timeTooltip.show)if(1>=this.playerStatus.current.duration)this.timeTooltip.show=
!1;else{this.timeTooltip.x=b.x;var a=document.getElementById("pos-slider").getBoundingClientRect();this.timeTooltip.y=a.y;this.timeTooltip.text=""+formatSeconds(Math.floor(this.playerStatus.current.duration*(b.clientX-a.x)/a.width))}},setInfoTrack:function(){this.infoTrack={title:this.playerStatus.current.title,track_id:this.playerStatus.current.id,artist:this.playerStatus.current.artist,artist_id:this.playerStatus.current.artist_ids?this.playerStatus.current.artist_ids.split(",")[0].trim():this.playerStatus.current.artist_id,
artist_ids:this.playerStatus.current.artist_ids,albumartist:this.playerStatus.current.albumartist,albumartist_ids:this.playerStatus.current.albumartist_ids,album:this.playerStatus.current.albumName,album_id:this.playerStatus.current.album_id}},trackInfo:function(){void 0==this.playerStatus.current.id?bus.$emit("showMessage",i18n("Nothing playing")):(this.largeView=this.info.show=!1,bus.$emit("trackInfo",{id:"track_id:"+this.playerStatus.current.id,title:this.playerStatus.current.title,image:this.coverUrl},
this.playerStatus.playlist.current,"now-playing"),this.desktop||this.$store.commit("setPage","browse"))},fetchLyrics:function(){var b=this;if(this.info.tabs[LYRICS_TAB].artist!=this.infoTrack.artist||this.info.tabs[LYRICS_TAB].songtitle!=this.infoTrack.title||this.infoTrack.track_id&&this.info.tabs[LYRICS_TAB].track_id!=this.infoTrack.track_id||this.infoTrack.artist_id&&this.info.tabs[LYRICS_TAB].artist_id!=this.infoTrack.artist_id){this.info.tabs[LYRICS_TAB].text=i18n("Fetching...");this.info.tabs[LYRICS_TAB].track_id=
this.infoTrack.track_id;this.info.tabs[LYRICS_TAB].artist=this.infoTrack.artist;this.info.tabs[LYRICS_TAB].artist_id=this.infoTrack.artist_id;this.info.tabs[LYRICS_TAB].songtitle=this.infoTrack.title;var a=["musicartistinfo","lyrics","html:1"];void 0==this.infoTrack.track_id||(""+this.infoTrack.track_id).startsWith("-")?(void 0!=this.infoTrack.title&&a.push("title:"+this.infoTrack.title),void 0!=this.infoTrack.artist&&a.push("artist:"+this.infoTrack.artist)):a.push("track_id:"+this.infoTrack.track_id);
3==a.length?this.info.tabs[LYRICS_TAB].text="":lmsCommand("",a).then(function(a){(a=a.data)&&a.result&&(a.result.lyrics||a.result.error)&&(b.info.tabs[LYRICS_TAB].text=a.result.lyrics?replaceNewLines(a.result.lyrics):a.result.error)}).catch(function(a){b.info.tabs[LYRICS_TAB].text=i18n("Failed to retreive information.")})}},fetchBio:function(){var b=this;if(this.info.tabs[BIO_TAB].artist!=this.infoTrack.artist||this.infoTrack.artist_id&&this.info.tabs[BIO_TAB].artist_id!=this.infoTrack.artist_id){this.info.tabs[BIO_TAB].text=
i18n("Fetching...");this.info.tabs[BIO_TAB].artist=this.infoTrack.artist;this.info.tabs[BIO_TAB].artist_id=this.infoTrack.artist_id;var a=this.infoTrack.artist_ids?this.infoTrack.artist_ids.split(","):[];if(1<a.length){this.info.tabs[BIO_TAB].first=!0;this.info.tabs[BIO_TAB].found=!1;this.info.tabs[BIO_TAB].count=a.length;for(var c=0,d=a.length;c<d;++c)lmsCommand("",["musicartistinfo","biography","artist_id:"+a[c].trim(),"html:1"]).then(function(a){(a=a.data)&&a.result&&(a.result.biography||a.result.error)&&
a.result.artist&&(b.info.tabs[BIO_TAB].found=!0,b.info.tabs[BIO_TAB].first?(b.info.tabs[BIO_TAB].text="",b.info.tabs[BIO_TAB].first=!1):b.info.tabs[BIO_TAB].text+="<br/><br/>",b.info.tabs[BIO_TAB].text+="<b>"+a.result.artist+"</b><br/>"+(a.result.biography?replaceNewLines(a.result.biography):a.result.error));b.info.tabs[BIO_TAB].count--;0!=b.info.tabs[BIO_TAB].count||b.info.tabs[BIO_TAB].found||(b.info.tabs[BIO_TAB].text=i18n("No artist found"))})}else a=["musicartistinfo","biography","html:1"],void 0!=
this.infoTrack.artist_id?a.push("artist_id:"+this.infoTrack.artist_id):a.push("artist:"+this.infoTrack.artist),3==a.length?this.info.tabs[BIO_TAB].text="":lmsCommand("",a).then(function(a){(a=a.data)&&a.result&&(a.result.biography||a.result.error)&&(b.info.tabs[BIO_TAB].text=a.result.biography?replaceNewLines(a.result.biography):a.result.error)}).catch(function(a){b.info.tabs[BIO_TAB].text=i18n("Failed to retreive information.")})}},fetchReview:function(){var b=this;if(this.info.tabs[REVIEW_TAB].albumartist!=
this.infoTrack.albumartist||this.info.tabs[REVIEW_TAB].album!=this.infoTrack.album||this.infoTrack.albumartist_ids&&this.info.tabs[REVIEW_TAB].albumartist_ids!=this.infoTrack.albumartist_ids||this.infoTrack.album_id&&this.info.tabs[REVIEW_TAB].album_id!=this.infoTrack.album_id){this.info.tabs[REVIEW_TAB].text=i18n("Fetching...");this.info.tabs[REVIEW_TAB].albumartist=this.infoTrack.albumartist;this.info.tabs[REVIEW_TAB].albumartist_ids=this.infoTrack.albumartist_ids;this.info.tabs[REVIEW_TAB].album=
this.infoTrack.album;this.info.tabs[REVIEW_TAB].artist_id=this.infoTrack.artist_id;this.info.tabs[REVIEW_TAB].album_id=this.infoTrack.album_id;var a=["musicartistinfo","albumreview","html:1"];void 0!=this.infoTrack.album_id?a.push("album_id:"+this.infoTrack.album_id):(void 0!=this.infoTrack.album&&a.push("album:"+this.infoTrack.album),void 0!=this.infoTrack.albumartist_ids?a.push("artist_id:"+this.infoTrack.albumartist_ids.split(", ")[0].trim()):void 0!=this.infoTrack.artist_id&&a.push("artist_id:"+
this.infoTrack.artist_id),void 0!=this.infoTrack.albumartist?a.push("artist:"+this.infoTrack.albumartist):void 0!=this.infoTrack.artist&&a.push("artist:"+this.infoTrack.artist));3==a.length?this.info.tabs[REVIEW_TAB].text="":lmsCommand("",a).then(function(a){(a=a.data)&&a.result&&(a.result.albumreview||a.result.error)&&(b.info.tabs[REVIEW_TAB].text=a.result.albumreview?replaceNewLines(a.result.albumreview):a.result.error)}).catch(function(a){b.info.tabs[REVIEW_TAB].text=i18n("Failed to retreive information.")})}},
showInfo:function(){this.info.show&&this.infoTrack&&(this.$nextTick(function(){var b=document.getElementById("np-info");b&&(b.style.backgroundImage="url('"+(this.$store.state.infoBackdrop&&this.coverUrl!=LMS_BLANK_COVER?this.coverUrl:"")+"')")}),this.desktop&&!this.showTabs?(this.fetchLyrics(),this.fetchBio(),this.fetchReview()):LYRICS_TAB==this.info.tab?this.fetchLyrics():BIO_TAB==this.info.tab?this.fetchBio():this.fetchReview())},startPositionInterval:function(){this.stopPositionInterval();this.positionInterval=
setInterval(function(){if(void 0!=this.playerStatus.current.time&&0<=this.playerStatus.current.time){var b=((new Date).getTime()-this.playerStatus.current.updated.getTime())/1E3;this.playerStatus.current.time=this.playerStatus.current.origTime+b;this.setPosition();this.playerStatus.current.duration&&0<this.playerStatus.current.duration&&this.playerStatus.current.time>=this.playerStatus.current.duration+2&&bus.$emit("refreshStatus")}}.bind(this),1E3)},stopPositionInterval:function(){void 0!==this.positionInterval&&
(clearInterval(this.positionInterval),this.positionInterval=void 0)},toggleTime:function(){0<this.$store.state.visibleMenus.size||(this.showTotal=!this.showTotal,setLocalStorageVal("showTotal",this.showTotal))},setBgndCover:function(){!this.page||this.desktop&&!this.largeView||setBgndCover(this.page,this.$store.state.nowPlayingBackdrop&&this.coverUrl!=LMS_BLANK_COVER?this.coverUrl:void 0,this.$store.state.darkUi)},playPauseButton:function(b){0<this.$store.state.visibleMenus.size||(b?bus.$emit("dlg.open",
"sleep",this.$store.state.player):this.doAction([this.playerStatus.isplaying?"pause":"play"]))},repeatOff:function(b){b?bus.$emit("dlg.open","dstm"):bus.$emit("playerCommand",["playlist","repeat",2])},showSleep:function(){0<this.$store.state.visibleMenus.size||bus.$emit("dlg.open","sleep",this.$store.state.player)},setRating:function(){var b=this;lmsCommand(this.$store.state.player.id,["trackstat","setrating",this.playerStatus.current.id,this.rating.value]).then(function(a){bus.$emit("refreshStatus");
bus.$emit("ratingChanged",b.playerStatus.current.id,b.playerStatus.current.album_id)})},doCommand:function(b,a){lmsCommand(this.$store.state.player.id,b).then(function(b){void 0!=a&&bus.$emit("showMessage",a)})},clickImage:function(b){this.menu.show?this.menu.show=!1:0<this.$store.state.visibleMenus.size||(this.clickTimer?(this.clearClickTimeout(this.clickTimer),this.showPic()):this.clickTimer=setTimeout(function(){this.clearClickTimeout(this.clickTimer);isIOS()&&this.showMenu(b)}.bind(this),LMS_DOUBLE_CLICK_TIMEOUT))},
clearClickTimeout:function(){this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=void 0)},touchStart:function(b){this.$store.state.swipeVolume&&!this.menu.show&&b.touches&&0<b.touches.length&&(this.touch={x:b.touches[0].clientX,y:b.touches[0].clientY,moving:!1},this.lastSentVolume=-1)},touchEnd:function(){this.touch&&this.touch.moving&&0<=this.overlayVolume&&this.overlayVolume!=this.lastSentVolume&&bus.$emit("playerCommand",["mixer","volume",this.overlayVolume]);this.touch=void 0;this.lastSentVolume=
this.overlayVolume=-1;this.cancelSendVolumeTimer()},touchMoving:function(b){if(void 0!=this.touch&&48>Math.abs(b.touches[0].clientX-this.touch.x)&&(!this.touch.moving&&10<Math.abs(b.touches[0].clientY-this.touch.y)&&(this.touch.moving=!0,this.lastSentVolume=this.overlayVolume=Math.abs(this.volume)),25<=Math.abs(b.touches[0].clientY-this.touch.y))){var a=Math.floor(Math.abs(b.touches[0].clientY-this.touch.y)/25);if(0<a){b=b.touches[0].clientY<this.touch.y;for(var c=0;c<a;++c)if(this.overlayVolume=
adjustVolume(Math.abs(this.overlayVolume),b),0>this.overlayVolume){this.overlayVolume=0;break}else if(100<this.overlayVolume){this.overlayVolume=100;break}this.touch.y+=25*a*(b?-1:1);this.resetSendVolumeTimer()}}},cancelSendVolumeTimer:function(){void 0!==this.sendVolumeTimer&&(clearTimeout(this.sendVolumeTimer),this.sendVolumeTimer=void 0)},resetSendVolumeTimer:function(){this.cancelSendVolumeTimer();this.sendVolumeTimer=setTimeout(function(){this.overlayVolume!=this.lastSentVolume&&(bus.$emit("playerCommand",
["mixer","volume",this.overlayVolume]),this.lastSentVolume=this.overlayVolume)}.bind(this),LMS_VOLUME_DEBOUNCE)}},filters:{displayTime:function(b){return void 0==b||0>b?"":formatSeconds(Math.floor(b))},svgIcon:function(b,a){return"/material/svg/"+b+"?c="+(a?LMS_DARK_SVG:LMS_LIGHT_SVG)+"&r="+LMS_MATERIAL_REVISION},limitStr:function(b){return void 0==b||80>b.length?b:b.substring(0,80)+"..."},trackCount:function(b,a,c){return void 0==b||void 0==a||2>a?"":(void 0==c?"":c)+(b+1)+" / "+a}},watch:{"info.show":function(b){bus.$emit("dialogOpen",
"info-dialog",b);this.setInfoTrack();this.showInfo()},"info.tab":function(b){this.showInfo()},"info.showTabs":function(){setLocalStorageVal("showTabs",this.info.showTabs)},"info.sync":function(){setLocalStorageVal("syncInfo",this.info.sync);this.info.sync&&(this.setInfoTrack(),this.showInfo())},largeView:function(b){if(b){if(!this.before){var a=document.getElementById("np-bar");a&&(this.before=a.style)}this.$nextTick(function(){this.page=document.getElementById("np-page");this.setBgndCover()})}else this.before&&
this.$nextTick(function(){var a=document.getElementById("np-bar");a&&(a.style=this.before)}),this.page=void 0;bus.$emit("largeViewVisible",b)},landscape:function(b){var a=this;b||this.$nextTick(function(){a.portraitElem=document.getElementById("np-page");a.lastWidth=a.portraitElem?a.portraitElem.offsetWidth:0;a.lastHeight=a.portraitElem?a.portraitElem.offsetHeight:0;a.calcPortraitPad()})},"menu.show":function(b){this.$store.commit("menuVisible",{name:"nowplaying",shown:b})}},computed:{infoPlugin:function(){return this.$store.state.infoPlugin},
stopButton:function(){return this.$store.state.stopButton},techInfo:function(){return this.$store.state.techInfo},formattedTime:function(){return this.playerStatus&&this.playerStatus.current?!this.showTotal&&void 0!=this.playerStatus.current.time&&0<this.playerStatus.current.duration?formatSeconds(Math.floor(this.playerStatus.current.time))+" / -"+formatSeconds(Math.floor(this.playerStatus.current.duration-this.playerStatus.current.time)):(void 0!=this.playerStatus.current.time?formatSeconds(Math.floor(this.playerStatus.current.time)):
"")+(void 0!=this.playerStatus.current.time&&0<this.playerStatus.current.duration?" / ":"")+(0<this.playerStatus.current.duration?formatSeconds(Math.floor(this.playerStatus.current.duration)):""):void 0},darkUi:function(){return this.$store.state.darkUi},ratingsSupported:function(){return this.$store.state.ratingsSupport},showRatings:function(){return this.$store.state.ratingsSupport&&this.playerStatus&&this.playerStatus.current&&this.playerStatus.current.duration&&0<this.playerStatus.current.duration&&
void 0!=this.playerStatus.current.id&&!(""+this.playerStatus.current.id).startsWith("-")},maxRating:function(){return this.$store.state.maxRating},title:function(){return this.$store.state.nowPlayingTrackNum&&this.playerStatus.current.tracknum?(9<this.playerStatus.current.tracknum?this.playerStatus.current.tracknum:"0"+this.playerStatus.current.tracknum)+SEPARATOR+this.playerStatus.current.title:this.playerStatus.current.title},menuIcons:function(){return this.$store.state.menuIcons}},beforeDestroy:function(){this.stopPositionInterval();
this.clearClickTimeout()}});
