Vue.component("lms-randommix",{template:'\n<v-dialog v-model="show" v-if="show" persistent scrollable width="600">\n <v-card>\n  <v-card-text>\n   <v-select :items="mixes" :label="i18n(\'Mix Type\')" v-model="chosenMix" item-text="label" item-value="key"></v-select>\n   <v-select chips deletable-chips multiple :items="genres" :label="i18n(\'Selected Genres\')" v-model="chosenGenres">\n    <v-list-tile slot="prepend-item" @click="toggleGenres()">\n     <v-list-tile-action><v-icon>{{selectAllIcon}}</v-icon></v-list-tile-action>\n     <v-list-tile-title>{{i18n(\'Select All\')}}</v-list-tile-title>\n    </v-list-tile>\n    <v-divider slot="prepend-item"></v-divider>\n   </v-select>\n   <v-select v-if="libraries.length>1" :items="libraries" :label="i18n(\'Library\')" v-model="library" item-text="name" item-value="id"></v-select>\n  </v-card-text>\n  <v-card-actions>\n   <v-spacer></v-spacer>\n   <v-btn flat @click.native="close()">{{i18n(\'Close\')}}</v-btn>\n   <v-btn flat @click.native="stop()" v-if="active">{{i18n(\'Stop\')}}</v-btn>\n   <v-btn flat @click.native="start()">{{i18n(\'Start\')}}</v-btn>\n  </v-card-actions>\n </v-card>\n</v-dialog>\n',
props:[],data:function(){return{show:!1,genres:[],chosenGenres:[],mixes:[],chosenMix:"tracks",active:!1,libraries:[],library:void 0}},computed:{selectAllIcon:function(){return this.chosenGenres.length==this.genres.length?"check_box":0<this.chosenGenres.length?"indeterminate_check_box":"check_box_outline_blank"}},mounted:function(){bus.$on("rndmix.open",function(){var a=this;this.playerId=this.$store.state.player.id;lmsCommand(this.playerId,["randomplayisactive"]).then(function(b){(b=b.data)&&b.result&&
b.result._randomplayisactive?(a.chosenMix=b.result._randomplayisactive,a.active=!0):(a.active=!1,a.choseMix="tracks");a.mixes=[{key:"tracks",label:i18n("Song Mix")},{key:"albums",label:i18n("Album Mix")},{key:"contributors",label:i18n("Artist Mix")},{key:"year",label:i18n("Year Mix")}];a.chosenGenres=[];a.genres=[];lmsList(a.playerId,["randomplaygenrelist"],void 0,0,500).then(function(b){(b=b.data)&&b.result&&b.result.item_loop&&(b.result.item_loop.forEach(function(b){void 0!==b.checkbox&&(a.genres.push(b.text),
1==b.checkbox&&a.chosenGenres.push(b.text))}),a.show=!0)})});lmsList("",["libraries"]).then(function(b){if((b=b.data)&&b.result&&b.result.folder_loop&&0<b.result.folder_loop.length){a.libraries=[];for(var c=0,d=b.result.folder_loop.length;c<d;++c)b.result.folder_loop[c].name=b.result.folder_loop[c].name.replace(SIMPLE_LIB_VIEWS,""),a.libraries.push(b.result.folder_loop[c]);a.libraries.sort(nameSort);a.libraries.unshift({name:i18n("All"),id:LMS_DEFAULT_LIBRARY});void 0==a.library&&(a.library=LMS_DEFAULT_LIBRARY)}})}.bind(this));
bus.$on("noPlayers",function(){this.show=!1}.bind(this));bus.$on("esc",function(){"rndmix"==this.$store.state.activeDialog&&(this.show=!1)}.bind(this))},methods:{close:function(){this.show=!1},start:function(){var a=this;this.close();lmsCommand(this.playerId,["randomplaychooselibrary",this.library]).then(function(b){0==a.chosenGenres.length?lmsCommand(a.playerId,["randomplaygenreselectall","0"]).then(function(b){lmsCommand(a.playerId,["randomplay",a.chosenMix])}):a.chosenGenres.length==a.genres.length?
lmsCommand(a.playerId,["randomplaygenreselectall","1"]).then(function(b){lmsCommand(a.playerId,["randomplay",a.chosenMix])}):lmsCommand(a.playerId,["randomplaygenreselectall","0"]).then(function(b){a.addGenre()})})},stop:function(){this.close();lmsCommand(this.playerId,["randomplay","disable"])},addGenre:function(){var a=this;0==this.chosenGenres.length?lmsCommand(this.playerId,["randomplay",this.chosenMix]):lmsCommand(this.playerId,["randomplaychoosegenre",this.chosenGenres.shift(),"1"]).then(function(b){a.addGenre()})},
toggleGenres:function(){this.chosenGenres=this.chosenGenres.length==this.genres.length?[]:this.genres.slice()},i18n:function(a){return this.show?i18n(a):a}},watch:{show:function(a){this.$store.commit("dialogOpen",{name:"rndmix",shown:a})}}});
