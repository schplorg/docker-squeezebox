var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(c){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var c=Object.seal({}),b=Object.seal({}),d=new a([[c,2],[b,3]]);if(2!=d.get(c)||3!=d.get(b))return!1;d.delete(c);d.set(b,4);return!d.has(c)&&4==d.get(b)}catch(l){return!1}}function c(){}function d(a){if(!$jscomp.owns(a,f)){var b=new c;$jscomp.defineProperty(a,f,{value:b})}}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};h.prototype.set=function(a,c){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=c;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=b.get(c)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var d=b.entries(),e=d.next();if(e.done||e.value[0]!=c||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};d.prototype.set=function(a,c){a=0===a?0:a;var b=e(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=c:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(c,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++h,c.set(b,d)):d="p_"+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var f=b.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)this.add(c.value)}this.size=this.map_.size};c.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,c){var b=this;this.map_.forEach(function(d){return a.call(c,d,d,b)})};return c},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var b="";a;)if(a&1&&(b+=c),a>>>=1)c+=c;return b}},"es6","es3");var DAYS_OF_WEEK="Sun Mon Tues Weds Thurs Fri Sat".split(" ");
Vue.component("lms-player-settings",{template:'\n<div>\n <v-dialog v-model="show" v-if="show" scrollable fullscreen>\n  <v-card>\n   <v-card-title class="settings-title">\n    <v-toolbar color="primary" dark app class="lms-toolbar">\n     <v-btn flat icon @click.native="close"><v-icon>arrow_back</v-icon></v-btn>\n    <v-toolbar-title>{{TB_PLAYER_SETTINGS.title}}</v-toolbar-title>\n   </v-toolbar>\n  </v-card-title>\n\n  <v-card-text>\n   <v-list two-line subheader class="settings-list">\n    <v-header class="dialog-section-header">{{i18n(\'General\')}}</v-header>\n    <v-list-tile>\n     <v-text-field clearable :label="i18n(\'Name\')" v-model="playerName" class="lms-search"></v-text-field>\n    </v-list-tile>\n    <div class="dialog-padding"></div>\n    <v-header class="dialog-section-header">{{i18n(\'Audio\')}}</v-header>\n    <v-list-tile>\n     <v-select :items="crossfadeItems" :label="i18n(\'On song change\')" v-model="crossfade" item-text="label" item-value="key"></v-select>\n    </v-list-tile>\n    <v-list-tile>\n     <v-select :items="replaygainItems" :label="i18n(\'Volume gain\')" v-model="replaygain" item-text="label" item-value="key"></v-select>\n    </v-list-tile>\n    <v-list-tile v-if="dstmItems && dstmItems.length>1">\n     <v-select :items="dstmItems" :label="trans.dstm" v-model="dstm" item-text="label" item-value="key"></v-select>\n    </v-list-tile>\n\n    <div class="dialog-padding"></div>\n    <v-header class="dialog-section-header">{{i18n(\'Sleep\')}} {{sleepTime | displayTime}}</v-header>\n\n    <v-list-tile>\n     <v-btn @click="setSleep()" flat style="margin-left:-8px"><v-icon class="btn-icon">hotel</v-icon>{{i18n(\'Set sleep timer\')}}</v-btn>\n    </v-list-tile>\n    <div class="dialog-padding"></div>\n    <v-header class="dialog-section-header">{{i18n(\'Alarms\')}}</v-header>\n     <v-list-tile>\n      <v-list-tile-content @click="alarms.on = !alarms.on" class="switch-label">\n       <v-list-tile-title>{{i18n(\'Enable alarms\')}}</v-list-tile-title>\n       <v-list-tile-sub-title>{{i18n(\'Enable alarm fuctionality.\')}}</v-list-tile-sub-title>\n      </v-list-tile-content>\n      <v-list-tile-action><v-switch v-model="alarms.on"></v-switch></v-list-tile-action>\n     </v-list-tile>\n      <div class="settings-sub-pad"></div>\n     <v-subheader class="alarm-sched-header">{{i18n(\'Scheduled alarms\')}}</v-subheader>\n     <template v-for="(item, index) in alarms.scheduled">\n      <v-list-tile class="alarm-entry">\n       <v-checkbox v-model="item.enabled" :label="item | formatAlarm" @click.stop="toggleAlarm(item)"></v-checkbox>\n       <v-btn flat icon @click.stop="editAlarm(item)" class="toolbar-button"><v-icon>edit</v-icon></v-btn>\n       <v-btn flat icon @click.stop="deleteAlarm(item)" class="toolbar-button"><v-icon>delete</v-icon></v-btn>\n      </v-list-tile>\n      <v-divider v-if="(index+1 < alarms.scheduled.length)" class="alarm-divider"></v-divider>\n     </template>\n     <v-btn flat @click.stop="addAlarm()" class="alarm-add"><v-icon class="btn-icon">alarm_add</v-icon>{{i18n("Add alarm")}}</v-btn>\n     <div class="settings-sub-pad"></div>\n     <v-subheader>{{i18n(\'Alarm settings\')}}</v-subheader>\n     <v-list-tile>\n      <v-text-field :label="i18n(\'Volume (%)\')" v-model="alarms.volume" type="number"></v-text-field>\n     </v-list-tile>\n     <v-list-tile>\n      <v-text-field :label="i18n(\'Snooze (minutes)\')" v-model="alarms.snooze" type="number"></v-text-field>\n     </v-list-tile>\n     <v-list-tile>\n      <v-text-field :label="i18n(\'Timeout (minutes)\')" v-model="alarms.timeout" type="number"></v-text-field>\n     </v-list-tile>\n\n     <div class="dialog-padding"></div>\n     <v-header class="dialog-section-header">{{i18n(\'Browse modes\')}}</v-header>\n     <v-list-tile class="settings-note"><p>{{i18n("Each player can have its own unique set of browse modes (Artists, Albums, Genres, etc). This is the set of options that will appear within the \'My Music\' section. Use the button below to configure which modes will be available for this player.")}}</p></v-list-tile>\n     <v-btn @click="browseModesDialog.show=true" flat><v-icon class="btn-icon">library_music</v-icon>{{i18n(\'Configure browse modes\')}}</v-btn>\n\n     <div class="dialog-padding"></div>\n     <div class="dialog-padding"></div>\n     <v-header class="dialog-section-header">{{i18n(\'Extra settings\')}}</v-header>\n     <v-list-tile class="settings-note"><p>{{i18n(\'The above are only the basic settings for a player, to access further settings use the button below.\')}}</p></v-list-tile>\n     <v-btn @click="showAllSettings" flat><v-icon class="btn-icon">settings</v-icon>{{i18n(\'Show extra settings\')}}</v-btn>\n     <div class="dialog-padding"></div>\n    </v-list>\n   </v-card-text>\n  </v-card>\n </v-dialog>\n\n <v-dialog v-model="browseModesDialog.show" :width="wide>1 ? 750 : 500" persistent>\n  <v-card>\n   <v-card-title>{{i18n("Browse modes")}}</v-card-title>\n    <v-list two-line subheader class="settings-list">\n     <v-layout v-if="wide>1">\n      <v-flex xs6>\n       <template v-for="(item, index) in browseModesDialog.modes">\n        <v-checkbox v-if="index<(browseModesDialog.modes.length/2)" v-model="item.enabled" :label="item.name" class="player-settings-list-checkbox"></v-checkbox>\n       </template>\n      </v-flex>\n      <v-flex xs6>\n       <template v-for="(item, index) in browseModesDialog.modes">\n        <v-checkbox v-if="index>=(browseModesDialog.modes.length/2)" v-model="item.enabled" :label="item.name" class="player-settings-list-checkbox"></v-checkbox>\n       </template>\n      </v-flex>\n     </v-layout>\n     <template v-for="(item, index) in browseModesDialog.modes" v-else>\n      <v-checkbox v-model="item.enabled" :label="item.name" class="player-settings-list-checkbox"></v-checkbox>\n     </template>\n    </v-list>\n   <div class="dialog-padding"></div>\n   <v-card-actions>\n    <v-spacer></v-spacer>\n    <v-btn flat @click="browseModesDialog.show = false">{{i18n(\'Close\')}}</v-btn>\n    </v-card-actions>\n   <v-card>\n </v-dialog>\n\n <v-dialog v-model="alarmDialog.show" width="500" persistent>\n  <v-card>\n  <v-card-title>{{alarmDialog.id ? i18n("Edit alarm") : i18n("Add alarm")}}</v-card-title>\n  <v-list two-line subheader class="settings-list">\n   <v-list-tile class="settings-compact-row">\n    <v-dialog ref="dialog" :close-on-content-click="false" v-model="alarmDialog.timepicker" :return-value.sync="alarmDialog.time"\n              persistent lazy full-width max-width="290px">\n     <v-text-field slot="activator" v-model="formattedTime" :label="i18n(\'Start time\')" prepend-icon="access_time" readonly></v-text-field>\n     <v-time-picker v-if="alarmDialog.timepicker" v-model="alarmDialog.time" full-width>\n      <v-spacer></v-spacer>\n      <v-btn flat @click="alarmDialog.timepicker = false">{{i18n(\'Cancel\')}}</v-btn>\n      <v-btn flat @click="$refs.dialog.save(alarmDialog.time)">{{i18n(\'OK\')}}</v-btn>\n     </v-time-picker>\n    </v-dialog>\n   </v-list-tile>\n   <div class="dialog-padding"></div>\n   <v-subheader>{{i18n(\'Days\')}}</v-subheader>\n   <v-list-tile class="settings-compact-row" v-if="wide>0">\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Monday\')" value="1"></v-checkbox></v-flex>\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Tuesday\')" value="2"></v-checkbox></v-flex>\n   </v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide>0">\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Wednesday\')" value="3"></v-checkbox></v-flex>\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Thursday\')" value="4"></v-checkbox></v-flex>\n   </v-list-tile>\n   <v-list-tile class="settings-compact-row"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Friday\')" value="5"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide>0">\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Saturday\')" value="6"></v-checkbox></v-flex>\n    <v-flex xs6><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Sunday\')" value="0"></v-checkbox></v-flex>\n   </v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Monday\')" value="1"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Tuesday\')" value="2"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Wednesday\')" value="3"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Thursday\')" value="4"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Friday\')" value="5"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Saturday\')" value="6"></v-checkbox></v-list-tile>\n   <v-list-tile class="settings-compact-row" v-if="wide==0"><v-checkbox class="ellipsis" v-model="alarmDialog.dow" :label="i18n(\'Sunday\')" value="0"></v-checkbox></v-list-tile>\n   <div class="dialog-padding"></div>\n   <v-subheader>{{i18n(\'Options\')}}</v-subheader>\n   <v-list-tile>\n    <v-select :items="alarmSounds" :label="i18n(\'Sound\')" v-model="alarmDialog.url" item-text="label" item-value="key"></v-select>\n   </v-list-tile>\n\n   \x3c!-- TODO ????\n   <v-list-tile class="settings-compact-row">\n    <v-select :items="alarmShuffeItems" :label="i18n(\'Shuffle\')" v-model="alarmDialog.shuffle" item-text="label" item-value="key"></v-select>\n   </v-list-tile>\n   --\x3e\n   <v-list-tile>\n    <v-list-tile-content @click="alarmDialog.repeat = !alarmDialog.repeat" class="switch-label">\n     <v-list-tile-title>{{i18n(\'Repeat\')}}</v-list-tile-title>\n     <v-list-tile-sub-title>{{i18n(\'Should alarms repeat\')}}</v-list-tile-sub-title>\n    </v-list-tile-content>\n    <v-list-tile-action><v-switch v-model="alarmDialog.repeat"></v-switch></v-list-tile-action>\n   </v-list-tile>\n  </v-list>\n  <div class="dialog-padding"></div>\n  <v-card-actions>\n   <v-spacer></v-spacer>\n   <v-btn flat @click="alarmDialog.show = false">{{i18n(\'Cancel\')}}</v-btn>\n   <v-btn flat @click="saveAlarm()">{{alarmDialog.id ? i18n("Save") : i18n("Create")}}</v-btn>\n   </v-card-actions>\n  </v-card>\n </v-dialog>\n\n</div>\n',props:[],
data:function(){return{show:!1,playerName:void 0,crossfade:void 0,replaygain:void 0,dstm:void 0,crossfadeItems:[],replaygainItems:[],dstmItems:[],alarms:{on:!0,volume:100,snooze:9,timeout:60,fade:!0,scheduled:[]},sleepTime:void 0,alarmShuffeItems:[],alarmSounds:[],alarmDialog:{show:!1,id:void 0,time:void 0,dow:[],repeat:!1,url:void 0,shuffle:void 0},wide:1,browseModesDialog:{show:!1,modes:[]},playerId:void 0,ttrans:{dstm:void 0}}},computed:{formattedTime:function(){if(!this.alarmDialog.time)return"";
var a=this.alarmDialog.time.split(":");return formatTime(3600*parseInt(a[0])+60*parseInt(a[1]),!1)}},mounted:function(){bus.$on("langChanged",function(){this.initItems()}.bind(this));this.initItems();bus.$on("playerStatus",function(a){this.show&&this.handlePlayerStatus(a)}.bind(this));bus.$on("otherPlayerStatus",function(a){this.show&&this.playerId==a.id&&this.handlePlayerStatus(a)}.bind(this));bus.$on("playersettings.open",function(a){void 0==a&&this.$store.state.player&&!this.show?this.playerSettings(this.$store.state.player):
void 0==a||this.show?this.$store.state.player||bus.$emit("showError",void 0,i18n("No Player")):this.playerSettings(a)}.bind(this));bus.$on("noPlayers",function(){this.show=this.alarmDialog.show=this.browseModesDialog.show=!1}.bind(this));this.sleepOpen=!1;bus.$on("dialogOpen",function(a,b){"sleep"==a&&(this.sleepOpen=b)}.bind(this));bus.$on("esc",function(){"alarm"==this.$store.state.activeDialog?this.alarmDialog.show=!1:"browsemodes"==this.$store.state.activeDialog?this.browseModesDialog.show=!1:
"playersettings"==this.$store.state.activeDialog&&(this.show=!1)}.bind(this));bus.$on("iframeClosed",function(a){a&&this.update(!0)}.bind(this))},methods:{handlePlayerStatus:function(a){this.controlSleepTimer(a.will_sleep_in)},playerSettings:function(a){var b=this;this.wide=700<=window.innerWidth?2:window.innerWidth>=(this.$store.state.largeFonts?410:370)?1:0;this.cancelSleepTimer();this.dstmItems=[];this.replaygain=this.crossfade="0";this.playerId=a.id;this.playerOrigName=this.playerName=a.name;
this.$store.state.dstmPlugin&&lmsCommand(this.playerId,["dontstopthemusicsetting"]).then(function(a){a=a.data;a.result&&a.result.item_loop&&a.result.item_loop.forEach(function(a){a.actions&&a.actions.do&&a.actions.do.cmd&&(b.dstmItems.push({key:a.actions.do.cmd[2],label:a.text}),1===a.radio&&(b.dstm=a.actions.do.cmd[2]))})});this.alarms.on=!0;this.alarms.volume=100;this.alarms.snooze=0;this.alarms.timeout=0;this.alarms.fade=!0;lmsCommand(this.playerId,["playerpref","alarmfadeseconds","?"]).then(function(a){(a=
a.data)&&a.result&&void 0!=a.result._p2&&(b.alarms.fade=1==a.result._p2)});lmsCommand(this.playerId,["playerpref","alarmTimeoutSeconds","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.alarms.timeout=Math.floor(parseInt(a.result._p2)/60))});lmsCommand(this.playerId,["playerpref","alarmSnoozeSeconds","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.alarms.snooze=Math.floor(parseInt(a.result._p2)/60))});lmsCommand(this.playerId,["playerpref","alarmsEnabled",
"?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.alarms.on=1==a.result._p2)});lmsCommand(this.playerId,["playerpref","alarmDefaultVolume","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.alarms.volume=a.result._p2)});this.alarmSounds=[];this.alarms.scheduled=[];lmsList(this.playerId,["alarm","playlists"],void 0,0).then(function(a){(a=a.data)&&a.result&&a.result.item_loop&&a.result.item_loop.forEach(function(a){a.url?b.alarmSounds.push({key:a.url,label:a.category+
": "+a.title}):b.alarmSounds.push({key:"CURRENT_PLAYLIST",label:i18n("Current play queue")})});1>b.alarmSounds.length&&b.alarmSounds.push({key:"CURRENT_PLAYLIST",label:i18n("Current play queue")});b.loadAlarms()});lmsCommand(this.playerId,["sleep","?"]).then(function(a){(a=a.data)&&a.result&&a.result._sleep&&b.controlSleepTimer(parseInt(a.result._sleep))});this.browseModesDialog.modes=[];this.prevEnabledModes=new Set;lmsCommand(this.playerId,["material-skin-modes","get"]).then(function(a){var c=a.data;
if(c.result&&c.result.modes_loop){a=0;c=c.result.modes_loop;for(var e=c.length;a<e;++a)c[a].weight=parseInt(c[a].weight),b.browseModesDialog.modes.push(c[a]),c[a].enabled&&b.prevEnabledModes.add(c[a].id);b.browseModesDialog.modes.sort(function(a,b){return a.weight!=b.weight?a.weight<b.weight?-1:1:nameSort(a,b)})}});this.update(!1);this.show=!0},initItems:function(){this.crossfadeItems=[{key:"0",label:i18n("No fade")},{key:"1",label:i18n("Crossfade")},{key:"2",label:i18n("Fade in")},{key:"3",label:i18n("Fade out")},
{key:"4",label:i18n("Fade in and out")}];this.replaygainItems=[{key:"0",label:i18n("None")},{key:"1",label:i18n("Track gain")},{key:"2",label:i18n("Album gain")},{key:"3",label:i18n("Smart gain")}];this.alarmShuffeItems=[{key:"0",label:i18n("Don't shuffle")},{key:"1",label:i18n("Shuffle by song")},{key:"2",label:i18n("Shuffle by album")}];DAYS_OF_WEEK=[i18n("Sun"),i18n("Mon"),i18n("Tues"),i18n("Weds"),i18n("Thurs"),i18n("Fri"),i18n("Sat")];this.trans={dstm:i18n("Don't Stop The Music")}},update:function(a){var b=
this;a&&lmsCommand(this.playerId,["playerpref","playername","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&b.playerName!=a.result._p2&&(b.playerName=a.result._p2)});lmsCommand(this.playerId,["playerpref","transitionType","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.crossfade=a.result._p2)});lmsCommand(this.playerId,["playerpref","replayGainMode","?"]).then(function(a){(a=a.data)&&a.result&&void 0!=a.result._p2&&(b.replaygain=a.result._p2)})},close:function(){var a=
this;this.show=!1;1<this.dstmItems.length&&lmsCommand(this.playerId,["playerpref","plugin.dontstopthemusic:provider",this.dstm]).then(function(b){bus.$emit("prefset","plugin.dontstopthemusic:provider",a.dstm)});lmsCommand(this.playerId,["playerpref","transitionType",this.crossfade]);lmsCommand(this.playerId,["playerpref","replayGainMode",this.replaygain]);lmsCommand(this.playerId,["playerpref","alarmfadeseconds",this.alarms.fade?1:0]);lmsCommand(this.playerId,["playerpref","alarmTimeoutSeconds",60*
this.alarms.timeout]);lmsCommand(this.playerId,["playerpref","alarmSnoozeSeconds",60*this.alarms.snooze]);lmsCommand(this.playerId,["playerpref","alarmsEnabled",this.alarms.on?1:0]);lmsCommand(this.playerId,["playerpref","alarmDefaultVolume",this.alarms.volume]);for(var b=new Set,c=[],d=[],e=0,f=this.browseModesDialog.modes,g=f.length;e<g;++e){var h=f[e];h.enabled?(b.add(h.id),c.push(h.id)):d.push(h.id)}e=new Set([].concat($jscomp.arrayFromIterable(b)).filter(function(b){return!a.prevEnabledModes.has(b)}));
f=new Set([].concat($jscomp.arrayFromIterable(this.prevEnabledModes)).filter(function(a){return!b.has(a)}));if(0<e.size||0<f.size){e=["material-skin-modes","set"];0<c.length&&e.push("enabled:"+c.join(","));0<d.length&&e.push("disabled:"+d.join(","));var k=this.playerId;lmsCommand(this.playerId,e).then(function(b){a.$store.state.player&&k==a.$store.state.player.id&&bus.$emit("playerMenuUpdated")})}this.playerOrigName!=this.playerName&&lmsCommand(this.playerId,["name",this.playerName]).then(function(a){bus.$emit("refreshServerStatus")});
this.playerId=void 0},loadAlarms:function(){var a=this;lmsList(this.playerId,["alarms"],["filter:all"],0).then(function(b){b=b.data;a.alarms.scheduled=[];b&&b.result&&b.result.alarms_loop&&b.result.alarms_loop.forEach(function(b){b.enabled=1==b.enabled;b.repeat=1==b.repeat;a.alarms.scheduled.push(b)})})},toggleAlarm:function(a){var b=this;lmsCommand(this.playerId,["alarm","update","enabled:"+(a.enabled?0:1),"id:"+a.id]).then(function(a){b.loadAlarms()})},addAlarm:function(){this.alarmDialog={show:!0,
id:void 0,time:"00:00",dow:["1","2","3","4","5"],repeat:!1,url:"CURRENT_PLAYLIST",shuffle:this.alarmShuffeItems[0].key}},editAlarm:function(a){this.alarmDialog={show:!0,id:a.id,time:formatTime(a.time,!0),dow:a.dow.split(","),repeat:a.repeat,url:a.url,enabled:a.enabled}},saveAlarm:function(){var a=this,b=this.alarmDialog.time.split(":");b=3600*parseInt(b[0])+60*parseInt(b[1]);var c=["alarm"];this.alarmDialog.id?(c.push("update"),c.push("id:"+this.alarmDialog.id),c.push("enabled:"+(this.alarmDialog.enabled?
1:0))):(c.push("add"),c.push("enabled:1"));c.push("time:"+b);c.push("dow:"+this.alarmDialog.dow.join(","));c.push("url:"+this.alarmDialog.url);c.push("repeat:"+(this.alarmDialog.repeat?1:0));lmsCommand(this.playerId,c).then(function(b){a.loadAlarms()});this.alarmDialog.show=!1},deleteAlarm:function(a){var b=this;this.$confirm(i18n("Delete alarm?"),{buttonTrueText:i18n("Delete"),buttonFalseText:i18n("Cancel")}).then(function(c){c&&lmsCommand(b.playerId,["alarm","delete","id:"+a.id]).then(function(a){b.loadAlarms()})})},
i18n:function(a){return this.show?i18n(a):a},setSleep:function(a){bus.$emit("dlg.open","sleep",{id:this.playerId,name:this.playerName})},cancelSleepTimer:function(){this.sleepTime=void 0;void 0!==this.sleepTimer&&(clearInterval(this.sleepTimer),this.sleepTimer=void 0)},controlSleepTimer:function(a){void 0!=a&&1<a?(a=Math.floor(a),this.timeLeft!=a&&(this.cancelSleepTimer(),this.timeLeft=this.sleepTime=a,this.start=new Date,this.sleepTimer=setInterval(function(){var a=((new Date).getTime()-this.start.getTime())/
1E3;this.sleepTime=this.timeLeft-a;0>=this.sleepTime&&(this.sleepTime=void 0,this.cancelSleepTimer())}.bind(this),1E3))):this.cancelSleepTimer()},showAllSettings:function(){bus.$emit("dlg.open","iframe","/material/settings/player/basic.html?player="+this.playerId,i18n("Extra player settings"))}},filters:{formatAlarm:function(a){var b=[],c=!1;a.dow.split(",").sort().forEach(function(a){"0"===a?c=!0:b.push(DAYS_OF_WEEK[a])});c&&b.push(DAYS_OF_WEEK[0]);return formatTime(a.time,!1)+" "+b.join(", ")+(a.repeat?
" ("+i18n("Repeat")+")":"")},displayTime:function(a){return void 0==a?"":"("+formatSeconds(Math.floor(a))+")"}},watch:{show:function(a){this.$store.commit("dialogOpen",{name:"playersettings",shown:a})},"alarmDialog.show":function(a){this.$store.commit("dialogOpen",{name:"alarm",shown:a})},"browseModesDialog.show":function(a){this.$store.commit("dialogOpen",{name:"browsemodes",shown:a})}}});
