var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,g=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var f=0;f<g&&c<e;)if(b[c++]!=a[f++])return!1;return f>=g}},"es6","es3");
Vue.component("lms-favorite",{template:'\n<v-dialog v-model="show" v-if="show" persistent width="600">\n <v-card>\n  <v-card-title>{{isAdd ? (isPreset ? i18n("Add preset") : i18n("Add favorite")) : (isPreset ? i18n("Edit preset") : i18n("Edit favorite"))}}</v-card-title>\n  <v-form ref="form" v-model="valid" lazy-validation>\n   <v-list two-line>\n    <v-list-tile>\n     <v-list-tile-content>\n      <v-text-field clearable autofocus v-if="show" :label="i18n(\'Name\')" v-model="name" class="lms-search"></v-text-field>\n     </v-list-tile-content>\n    </v-list-tile>\n    <v-list-tile>\n     <v-list-tile-content>\n      <v-text-field clearable :label="i18n(\'URL\')" v-model="url" class="lms-search"></v-text-field>\n     </v-list-tile-content>\n    </v-list-tile>\n    <v-list-tile v-if="isPreset && isAdd">\n     <v-list-tile-content>\n      <v-select :items="positions" label="Position" v-model="pos" item-text="label" item-value="key"></v-select>\n     </v-list-tile-content>\n    </v-list-tile>\n   </v-list>\n  </v-form>\n  <v-card-actions>\n   <v-spacer></v-spacer>\n   <v-btn flat @click.native="cancel()">{{i18n(\'Cancel\')}}</v-btn>\n   <v-btn flat @click.native="update()" v-if="!isAdd">{{i18n(\'Update\')}}</v-btn>\n   <v-btn flat @click.native="add()" v-if="isAdd">{{i18n(\'Add\')}}</v-btn>\n  </v-card-actions>\n </v-card>\n</v-dialog>\n',props:[],
data:function(){return{valid:!1,show:!1,name:"",url:"",item:void 0,isPreset:!1,isAdd:!0,pos:1,positions:[1,2,3,4,5,6,7,8,9,10]}},mounted:function(){bus.$on("favorite.open",function(a,b,c){this.isPreset=c;this.item=b;"edit"==a?(this.playerId=this.$store.state.player?this.$store.state.player.id:"",this.name=c?b.text:b.title,this.url=c?b.url?b.url:b.favUrl?b.favUrl:b.presetParams?b.presetParams.favorites_url:void 0:b.presetParams?b.presetParams.favorites_url:void 0,this.isAdd=!1,this.show=!0):"add"==
a&&(this.playerId=this.$store.state.player?this.$store.state.player.id:"",this.url=this.name="",this.show=this.isAdd=!0)}.bind(this));bus.$on("noPlayers",function(){this.show=!1}.bind(this));bus.$on("esc",function(){"favorite"==this.$store.state.activeDialog&&(this.show=!1)}.bind(this))},methods:{cancel:function(){this.show=!1},update:function(){var a=this,b=this.url?this.url.trim():"",c=this.name?this.name.trim():"";if(!(1>b.length||1>c.length)){if(this.isPreset)lmsCommand(this.playerId,["material-skin-presets",
"set","num:"+this.item.num,"url:"+b,"text:"+c]).then(function(a){bus.$emit("refreshList",SECTION_PRESETS)});else if(b==(this.item.presetParams?this.item.presetParams.favorites_url:void 0)){if(c==this.item.title)return;lmsCommand(this.playerId,["favorites","rename",this.item.id,"title:"+c]).then(function(a){bus.$emit("refreshFavorites");bus.$emit("refreshList",SECTION_FAVORITES)})}else lmsCommand(this.playerId,["favorites","delete",this.item.id]).then(function(d){d=["favorites","add","url:"+b,"title:"+
c,a.item.id];a.item.presetParams&&(a.item.presetParams.icon&&d.push("icon:"+a.item.presetParams.icon),a.item.presetParams.favorites_type&&d.push("type:"+a.item.presetParams.favorites_type),(a.item.presetParams.favorites_url&&(a.item.presetParams.favorites_url.startsWith("db:contributor")||a.item.presetParams.favorites_url.startsWith("db:genre")||a.item.presetParams.favorites_url.startsWith("db:album")||a.item.presetParams.favorites_url.startsWith("db:year"))||a.item["icon-id"]&&"html/images/playlists.png"==
a.item["icon-id"])&&d.push("hasitems:1"));lmsCommand(a.playerId,d).then(function(a){bus.$emit("refreshFavorites")})});this.show=!1}},add:function(){var a=this,b=this.url?this.url.trim():"",c=this.name?this.name.trim():"";1>b.length||1>c.length||(this.isPreset?lmsCommand(this.playerId,["material-skin-presets","set","num:"+this.pos,"url:"+b,"text:"+c]).then(function(a){bus.$emit("refreshList",SECTION_PRESETS)}):lmsCommand(this.playerId,["favorites","exists",b]).then(function(d){(d=d.data)&&d.result&&
1==d.result.exists?bus.$emit("showMessage",i18n("Already in favorites")):lmsCommand(a.playerId,["favorites","add","url:"+b,"title:"+c,a.item.id]).then(function(a){bus.$emit("refreshFavorites")})}),this.show=!1)},i18n:function(a){return this.show?i18n(a):a}},watch:{show:function(a){this.$store.commit("dialogOpen",{name:"favorite",shown:a})}}});
