var TB_UI_SETTINGS={id:"tb:settings",icon:"settings"},TB_PLAYER_SETTINGS={id:"tb:playersettings",icon:"speaker"},TB_INFO={id:"tb:info",icon:"info"},TB_MANAGE_PLAYERS={id:"tb-manageplayers",icon:"speaker_group"},TB_MINI_PLAYER={id:"tb:mini",icon:"open_in_new"},toolbarComponent,mediaAudio=void 0,mediaStarted=!1;
function initMediaSessionAudio(){void 0==mediaAudio&&(mediaAudio=document.createElement("audio"),window.removeEventListener("click",initMediaSessionAudio),setTimeout(function(){toolbarComponent.updateMediaSession(toolbarComponent.playerStatus.current,!0)},500))}
function startMediaSession(){mediaAudio&&!mediaStarted&&(mediaAudio.src="html/audio/silence.ogg",mediaAudio.play().then(function(a){mediaAudio.currentTime=0;mediaAudio.pause();toolbarComponent.updateMediaSession(toolbarComponent.playerStatus.current,!0);navigator.mediaSession.playbackState=toolbarComponent.playerStatus&&toolbarComponent.playerStatus.isplaying?"playing":"paused";mediaStarted=!0}).catch(function(a){}))}
function stopMediaSession(){mediaStarted&&(mediaStarted=!1,mediaAudio.src&&(mediaAudio.src=void 0),navigator.mediaSession.metadata=void 0)}
Vue.component("lms-toolbar",{template:'\n<div>\n<v-toolbar fixed dense app class="lms-toolbar noselect">\n <v-icon v-if="noPlayer" color="orange darken-2" class="toolbar-button">warning</v-icon>\n <div v-if="noPlayer && otherPlayers.length<1" class="noplayer-title ellipsis">{{trans.noplayer}}</div>\n <v-menu v-else bottom :disabled="!connected" class="ellipsis" v-model="showPlayerMenu">\n  <v-toolbar-title slot="activator">\n   <div class="maintoolbar-title ellipsis" v-bind:class="{\'dimmed\': !playerStatus.ison}">\n    {{noPlayer ? trans.noplayer : player.name}}<v-icon v-if="playerStatus.sleepTime" class="player-status-icon">hotel</v-icon><v-icon v-if="playerStatus.synced" class="player-status-icon">link</v-icon></div>\n   <div v-if="!desktop && !noPlayer" class="maintoolbar-subtitle subtext ellipsis" v-bind:class="{\'dimmed\' : !playerStatus.ison}">{{undefined===songInfo ? trans.nothingplaying : (!desktop && isNowPlayingPage && (!infoPlugin || !infoOpen)) ? playlist.count+playlist.duration : songInfo}}</div>\n  </v-toolbar-title>\n       \n  <v-list class="toolbar-player-list">\n   <template v-for="(item, index) in players">\n    <v-subheader v-if="index==0 && !item.isgroup && (players[players.length-1].isgroup || otherPlayers.length>0)">{{trans.standardPlayers}}</v-subheader>\n    <v-subheader v-else-if="index>0 && item.isgroup && !players[index-1].isgroup">{{trans.groupPlayers}}</v-subheader>\n    <v-list-tile @click="setPlayer(item.id)">\n     <v-list-tile-avatar v-if="players && players.length>1 || otherPlayers.length>0">\n      <v-icon small v-if="players && players.length>1">{{player && item.id === player.id ? \'radio_button_checked\' :\'radio_button_unchecked\'}}</v-icon>\n      <v-icon small v-else></v-icon>\n     </v-list-tile-avatar>\n     <v-list-tile-content>\n      <v-list-tile-title>{{item.name}}</v-list-tile-title>\n     </v-list-tile-content>\n      <v-list-tile-action v-if="index<10 && keyboardControl" class="menu-shortcut" v-bind:class="{\'menu-shortcut-player\':item.canpoweroff}">{{index|playerShortcut}}</v-list-tile-action>\n      <v-list-tile-action>\n       <v-btn icon><v-icon v-if="item.canpoweroff" style="float:right" v-bind:class="{\'dimmed\': (item.id==player.id ? !playerStatus.ison : !item.ison), \'active-btn\':(item.id==player.id ? playerStatus.ison : item.ison) }" @click.stop="togglePower(item)">power_settings_new</v-icon></\n      </v-list-tile-action>\n    </v-list-tile>\n   </template>\n   <template v-if="!mini && !nowplaying" v-for="(item, index) in otherPlayers">\n    <v-subheader v-if="0==index || item.server!=otherPlayers[index-1].server">{{item.server}}</v-subheader>\n    <v-list-tile @click="movePlayer(item)">\n     <v-list-tile-avatar><v-icon small></v-icon></v-list-tile-avatar>\n     <v-list-tile-content>\n      <v-list-tile-title>{{item.name}}</v-list-tile-title>\n     </v-list-tile-content>\n    </v-list-tile>\n   </template>\n\n   <v-divider v-if="!mini && !nowplaying && ((players && players.length>1) || playerStatus.sleepTime)"></v-divider>\n\n   <v-list-tile v-if="!mini && !nowplaying && multipleStandardPlayers" @click="bus.$emit(\'dlg.open\', \'sync\', player)">\n    <v-list-tile-avatar v-if="menuIcons"><v-icon>link</v-icon></v-list-tile-avatar>\n    <v-list-tile-content><v-list-tile-title>{{trans.synchronise}}</v-list-tile-title></v-list-tile-content>\n    <v-list-tile-action v-if="keyboardControl" class="menu-shortcut">{{trans.syncShortcut}}</v-list-tile-action>\n   </v-list-tile>\n\n   <v-list-tile v-if="!mini && !nowplaying && players && players.length>1" @click="menuAction(TB_MANAGE_PLAYERS.id)">\n    <v-list-tile-avatar v-if="menuIcons"><v-icon>{{TB_MANAGE_PLAYERS.icon}}</v-icon></v-list-tile-avatar>\n    <v-list-tile-content><v-list-tile-title>{{TB_MANAGE_PLAYERS.title}}</v-list-tile-title></v-list-tile-content>\n    <v-list-tile-action v-if="TB_MANAGE_PLAYERS.shortcut && keyboardControl" class="menu-shortcut">{{TB_MANAGE_PLAYERS.shortcut}}</v-list-tile-action>\n   </v-list-tile>\n\n   <v-list-tile v-if="!mini && !nowplaying && playerStatus.sleepTime" @click="bus.$emit(\'dlg.open\', \'sleep\', player)">\n    <v-list-tile-avatar><v-icon>hotel</v-icon></v-list-tile-avatar>\n    <v-list-tile-content>\n     <v-list-tile-title>{{playerStatus.sleepTime | displayTime}}</v-list-tile-title>\n    </v-list-tile-content>\n   </v-list-tile>\n  </v-list>\n </v-menu>\n <v-spacer></v-spacer>\n <v-btn v-show="desktop || wide" :disabled="!playerStatus.ison || noPlayer" icon flat class="toolbar-button" v-longpress="volumeDown" @click.middle="toggleMute" id="vol-down-btn"><v-icon>{{playerMuted ? \'volume_off\' : \'volume_down\'}}</v-icon></v-btn>\n <v-slider v-show="desktop || wide" :disabled="!playerStatus.ison || noPlayer" step="1" v-model="playerVolume" class="vol-slider vol-full-slider" @click.stop="setVolume" @click.middle="toggleMute" id="vol-slider" @start="volumeSliderStart" @end="volumeSliderEnd"></v-slider>\n <v-btn v-show="desktop || wide" :disabled="!playerStatus.ison || noPlayer" icon flat class="toolbar-button" v-longpress="volumeUp" @click.middle="toggleMute" id="vol-up-btn"><v-icon>{{playerMuted ? \'volume_off\' : \'volume_up\'}}</v-icon></v-btn>\n <p v-show="desktop || wide" class="vol-full-label" v-bind:class="{\'vol-full-label-np\': nowplaying, \'dimmed\':!playerStatus.ison || noPlayer}" @click.middle="toggleMute">{{playerVolume|displayVolume}}%</p>\n <v-btn v-show="!(desktop || wide)" :disabled="!playerStatus.ison || noPlayer" icon flat class="toolbar-button" v-longpress="volumeClick" @click.middle="toggleMute" id="vol-btn">\n  <v-icon v-if="playerStatus.volume>0">volume_up</v-icon>\n  <v-icon v-else-if="playerStatus.volume==0">volume_down</v-icon>\n  <v-icon v-else>volume_off</v-icon>\n </v-btn>\n <div class="vol-label" v-if="!(desktop || wide)" v-bind:class="{\'dimmed\':!playerStatus.ison || noPlayer}">{{playerStatus.volume|displayVolume}}%</div>\n <v-btn icon :title="trans.info | tooltip(trans.infoShortcut,keyboardControl)" v-if="!desktop && infoPlugin && isNowPlayingPage && !infoOpen" @click.stop="bus.$emit(\'info\')" class="toolbar-button" id="inf">\n  <v-icon>info_outline</v-icon>\n </v-btn>\n <v-btn icon v-if="!desktop && ( (isNowPlayingPage && (infoOpen || !infoPlugin)) || !isNowPlayingPage)" v-longpress="playPauseButton" @click.middle="showSleep" class="toolbar-button" id="pp">\n  <v-icon>{{playerStatus.isplaying ? \'pause_circle_outline\' : \'play_circle_outline\'}}</v-icon>\n </v-btn>\n <v-btn icon :title="trans.info | tooltip(trans.infoShortcut,keyboardControl)" v-if="desktop && infoPlugin && !mini && !nowplaying" @click.native="emitInfo" class="toolbar-button">\n  <v-icon>info_outline</v-icon>\n </v-btn>\n <v-btn icon :title="trans.showLarge | tooltip(trans.showLargeShortcut,keyboardControl)" v-if="desktop && !largeView && !mini && !nowplaying" @click.native="toggleLargeView(true)" class="toolbar-button">\n  <v-icon>fullscreen</v-icon>\n </v-btn>\n <v-btn icon :title="trans.hideLarge | tooltip(trans.showLargeShortcut,keyboardControl)" v-if="desktop && largeView && !mini && !nowplaying" @click.native="toggleLargeView(false)" class="toolbar-button">\n  <v-icon>fullscreen_exit</v-icon>\n </v-btn>\n <v-menu v-if="connected && !mini && !nowplaying" bottom left v-model="showMainMenu">\n  <v-btn slot="activator" icon><img v-if="pluginUpdatesAvailable" class="svg-img" :src="\'update\' | svgIcon(darkUi, true)"></img><v-icon v-else>more_vert</v-icon></v-btn>\n  <v-list>\n   <template v-for="(item, index) in menuItems">\n    <v-divider v-if="item===DIVIDER"></v-divider>\n    <v-list-tile v-else @click="menuAction(item.id)">\n     <v-list-tile-avatar v-if="menuIcons"><img v-if="TB_INFO.id==item.id && pluginUpdatesAvailable" class="svg-img" :src="\'update\' | svgIcon(darkUi, true)"></img><v-icon v-else>{{item.icon}}</v-icon></v-list-tile-avatar>\n     <v-list-tile-content>\n      <v-list-tile-title>{{item.title}}</v-list-tile-title>\n      <v-list-tile-sub-title v-if="TB_INFO.id==item.id && pluginUpdatesAvailable">{{trans.pluginUpdatesAvailable}}</v-list-tile-sub-title>\n     </v-list-tile-content>\n     <v-list-tile-action v-if="item.shortcut && keyboardControl" class="menu-shortcut">{{item.shortcut}}</v-list-tile-action>\n    </v-list-tile>\n   </template>\n   <v-list-tile v-if="showPlayerMenuEntry" href="intent://sbplayer/#Intent;scheme=angrygoat;package=com.angrygoat.android.sbplayer;end">\n    <v-list-tile-avatar v-if="menuIcons"><v-icon>surround_sound</v-icon></v-list-tile-avatar>\n    <v-list-tile-title>{{trans.startPlayer}}</v-list-tile-title>\n   </v-list-tile>\n   <v-divider v-if="!desktop && otherMenuItems[currentPage] && otherMenuItems[currentPage].length>0"></v-divider>\n   <template v-if="!desktop && otherMenuItems[currentPage] && otherMenuItems[currentPage].length>0" v-for="(action, index) in otherMenuItems[currentPage]">\n    <v-list-tile @click="bus.$emit(\'settingsMenuAction:\'+currentPage, action)">\n     <v-list-tile-avatar v-if="menuIcons">\n      <img v-if="ACTIONS[action].svg" class="svg-img" :src="ACTIONS[action].svg | svgIcon(darkUi)"></img>\n      <v-icon v-else>{{ACTIONS[action].icon}}</v-icon>\n     </v-list-tile-avatar>\n     <v-list-tile-content><v-list-tile-title>{{ACTIONS[action].title}}</v-list-tile-title></v-list-tile-content>\n     <v-list-tile-action v-if="ACTIONS[action].key && keyboardControl" class="menu-shortcut">{{shortcutStr(ACTIONS[action].key)}}</v-list-tile-action>\n    </v-list-tile>\n   </template>\n  </v-list>\n </v-menu>\n <v-btn v-else-if="!mini && !nowplaying" icon :title="trans.connectionLost" @click.native="bus.$emit(\'showError\', undefined, trans.connectionLost);">\n  <v-icon color="red">error</v-icon>\n </v-btn>\n</v-toolbar>\n<v-snackbar v-model="snackbar.show" :multi-line="true" :timeout="snackbar.timeout ? snackbar.timeout : 2500" :color="snackbar.color" top>{{ snackbar.msg }}</v-snackbar>\n</div>\n    ',props:["desktop",
"nowplaying","mini"],data:function(){return{songInfo:void 0,playlist:{count:"",duration:""},playerStatus:{ison:1,isplaying:!1,volume:0,synced:!1,sleepTime:void 0,current:{title:void 0,artist:void 0,album:void 0}},menuItems:[],showPlayerMenu:!1,showMainMenu:!1,otherMenuItems:{},trans:{noplayer:void 0,nothingplaying:void 0,synchronise:void 0,syncShortcut:void 0,info:void 0,infoShortcut:void 0,connectionLost:void 0,showLarge:void 0,showLargeShortcut:void 0,hideLarge:void 0,startPlayer:void 0,groupPlayers:void 0,
standardPlayers:void 0,otherServerPlayers:void 0,pluginUpdatesAvailable:void 0},infoOpen:!1,largeView:!1,playerVolume:0,playerMuted:!1,snackbar:{show:!1,msg:void 0},connected:!0,wide:!1}},mounted:function(){var a=this;this.mini||this.desktop||(setInterval(function(){this.wide=900<=window.innerWidth}.bind(this),1E3),bus.$on("windowWidthChanged",function(){this.wide=900<=window.innerWidth}.bind(this)));bus.$on("settingsMenuActions",function(b,a){this.otherMenuItems[a]=[];for(var c=0,d=b.length;c<d;++c)this.$set(this.otherMenuItems[a],
c,b[c]);this.$forceUpdate()}.bind(this));this.desktop||bus.$on("queueStatus",function(b,a){this.playlist.count=0<b?i18np("1 Track","%1 Tracks",b):"";this.playlist.duration=0<a?" ("+formatSeconds(Math.floor(a))+")":""}.bind(this));bus.$on("playerStatus",function(a){a.ison!=this.playerStatus.ison&&(this.playerStatus.ison=a.ison);a.isplaying!=this.playerStatus.isplaying&&(this.playerStatus.isplaying=a.isplaying);a.volume!=this.playerStatus.volume&&(this.playerStatus.volume=a.volume);this.controlSleepTimer(a.will_sleep_in);
a.synced!=this.playerStatus.synced&&(this.playerStatus.synced=a.synced);if(a.current.title!=this.playerStatus.current.title||a.current.artist&&a.current.artist!=this.playerStatus.current.artist||a.current.trackartist&&a.current.trackartist!=this.playerStatus.current.artist)this.playerStatus.current.title=a.current.title,this.playerStatus.current.artist=a.current.artist?a.current.artist:a.current.trackartist,this.playerStatus.current.album=a.current.album,this.songInfo=this.playerStatus.current.title?
this.playerStatus.current.artist?this.playerStatus.current.title+SEPARATOR+this.playerStatus.current.artist:this.playerStatus.current.title:this.playerStatus.current.artist?this.playerStatus.current.artist:void 0;if(!this.movingVolumeSlider){this.playerMuted=0>a.volume;var b=Math.abs(a.volume);b!=this.playerVolume&&(this.playerVolume=b)}this.updateMediaSession(a.current)}.bind(this));bus.$on("langChanged",function(){this.initItems()}.bind(this));this.initItems();bus.$on("esc",function(){this.showPlayerMenu=
!1}.bind(this));bus.$on("hideMenu",function(a){"main"==a?this.showMainMenu=!1:"player"==a&&(this.showPlayerMenu=!1)}.bind(this));bus.$on("dialogOpen",function(a,c){"info-dialog"==a&&(this.infoOpen=c);this.initItems()}.bind(this));bus.$on("largeViewVisible",function(a){this.largeView=a}.bind(this));this.desktop&&bus.$on("playerChanged",function(){this.playerVolume.id=void 0}.bind(this));bus.$on("showError",function(a,c){this.snackbar={msg:(c?c:i18n("Something went wrong!"))+(a?" ("+a+")":""),show:!0,
color:"error"}}.bind(this));bus.$on("showMessage",function(a){this.snackbar={msg:a,show:!0}}.bind(this));"mediaSession"in navigator&&IS_MOBILE&&(toolbarComponent=this,window.addEventListener("click",initMediaSessionAudio),this.media={title:void 0,artist:void 0,album:void 0,cover:void 0},navigator.mediaSession.setActionHandler("play",function(){a.playerStatus&&a.playerStatus.isplaying?bus.$emit("playerCommand",["pause"]):bus.$emit("playerCommand",["play"])}),navigator.mediaSession.setActionHandler("pause",
function(){bus.$emit("playerCommand",["pause"])}),navigator.mediaSession.setActionHandler("previoustrack",function(){bus.$emit("playerCommand",["button","jump_rew"])}),navigator.mediaSession.setActionHandler("nexttrack",function(){bus.$emit("playerCommand",["playlist","index","+1"])}),bus.$on("currentCover",function(a){this.media.cover=a;this.updateMediaSession(this.playerStatus.current,!0)}.bind(this)),bus.$emit("getCurrentCover"),bus.$on("haveLocalAndroidPlayer",function(a){this.updateMediaSession(void 0,
!0)}.bind(this)),bus.$on("lsAndNotifChanged",function(a){this.updateMediaSession(this.playerStatus.current,!0)}.bind(this)));bus.$on("networkStatus",function(a){a?(this.connected=!0,this.cancelDisconnectedTimer()):this.connected&&!this.disconnectedTimer&&(this.disconnectedTimer=setInterval(function(){this.connected=!1}.bind(this),1500))}.bind(this));IS_MOBILE||(this.desktop?(this.addMouseWheelhandler("vol-down-btn"),this.addMouseWheelhandler("vol-slider"),this.addMouseWheelhandler("vol-up-btn")):
this.addMouseWheelhandler("vol-btn"),this.mini||this.nowplaying||(bindKey(LMS_SETTINGS_KEYBOARD,"mod"),bindKey(LMS_PLAYER_SETTINGS_KEYBOARD,"mod"),bindKey(LMS_INFORMATION_KEYBOARD,"mod"),bindKey(LMS_MANAGEPLAYERS_KEYBOARD,"mod"),bindKey(LMS_SYNC_KEYBOARD,"mod"),bindKey("1","alt"),bindKey("2","alt"),bindKey("3","alt"),bindKey("4","alt"),bindKey("5","alt"),bindKey("6","alt"),bindKey("7","alt"),bindKey("8","alt"),bindKey("9","alt"),bindKey("0","alt"),bus.$on("keyboard",function(a,c){if(this.$store.state.keyboardControl&&
!(0<this.$store.state.openDialogs.length))if("mod"==c)if(1==this.$store.state.visibleMenus.size&&this.$store.state.visibleMenus.has("main")){if(LMS_SETTINGS_KEYBOARD==a||LMS_PLAYER_SETTINGS_KEYBOARD==a||LMS_INFORMATION_KEYBOARD==a)this.menuAction(LMS_SETTINGS_KEYBOARD==a?TB_UI_SETTINGS.id:LMS_PLAYER_SETTINGS_KEYBOARD==a?TB_PLAYER_SETTINGS.id:TB_INFO.id),bus.$emit("hideMenu","main")}else 1==this.$store.state.visibleMenus.size&&this.$store.state.visibleMenus.has("player")?LMS_MANAGEPLAYERS_KEYBOARD==
a&&1<this.$store.state.players.length?(this.menuAction(TB_MANAGE_PLAYERS.id),bus.$emit("hideMenu","player")):LMS_SYNC_KEYBOARD==a&&this.$store.state.players&&1<this.$store.state.players.length&&!this.$store.state.players[1].isgroup&&(bus.$emit("dlg.open","sync",this.$store.state.player),bus.$emit("hideMenu","player")):0==this.$store.state.visibleMenus.size&&(LMS_SETTINGS_KEYBOARD==a||LMS_PLAYER_SETTINGS_KEYBOARD==a||LMS_INFORMATION_KEYBOARD==a||LMS_MANAGEPLAYERS_KEYBOARD==a&&1<this.$store.state.players.length?
this.menuAction(LMS_SETTINGS_KEYBOARD==a?TB_UI_SETTINGS.id:LMS_PLAYER_SETTINGS_KEYBOARD==a?TB_PLAYER_SETTINGS.id:LMS_INFORMATION_KEYBOARD==a?TB_INFO.id:TB_MANAGE_PLAYERS.id):LMS_SYNC_KEYBOARD==a&&this.$store.state.players&&1<this.$store.state.players.length&&!this.$store.state.players[1].isgroup&&bus.$emit("dlg.open","sync",this.$store.state.player));else"alt"!=c||1!=a.length||isNaN(a)||(a=parseInt(a),a=0==a?10:a-1,a<this.$store.state.players.length&&(a=this.$store.state.players[a].id,a!=this.$store.state.player.id&&
this.setPlayer(a)))}.bind(this))))},methods:{addMouseWheelhandler:function(a){(a=document.getElementById(a))&&a.addEventListener("mousewheel",function(a){0>a.wheelDeltaY?this.volumeDown():0<a.wheelDeltaY&&this.volumeUp();return!1}.bind(this),{passive:!0})},updateMediaSession:function(a,b){if(mediaAudio&&"mediaSession"in navigator)if(haveLocalAndroidPlayer||"never"==this.$store.state.lsAndNotif||"playing"==this.$store.state.lsAndNotif&&(void 0==a||isEmpty(a.title)&&isEmpty(a.trackartist)&&isEmpty(a.artist)&&
isEmpty(a.album)))stopMediaSession(),this.media.title=void 0,this.media.artist=void 0,this.media.album=void 0;else{startMediaSession();navigator.mediaSession.playbackState=this.playerStatus&&this.playerStatus.isplaying?"playing":"paused";var c=a.trackartist?a.trackartist:a.artist;if(b||a.title!=this.media.title||c!=this.media.artist||a.album!=this.media.album)this.media.title=a.title,this.media.artist=c,this.media.album=a.album,navigator.mediaSession.metadata=new MediaMetadata({title:this.media.title,
artist:this.media.artist,album:this.media.album,artwork:[{src:""+this.media.cover,type:"image/jpeg"}]})}},initItems:function(){TB_UI_SETTINGS.title=i18n("Settings");TB_UI_SETTINGS.shortcut=shortcutStr(LMS_SETTINGS_KEYBOARD);TB_PLAYER_SETTINGS.title=i18n("Player settings");TB_PLAYER_SETTINGS.shortcut=shortcutStr(LMS_PLAYER_SETTINGS_KEYBOARD);TB_INFO.title=i18n("Information");TB_INFO.shortcut=shortcutStr(LMS_INFORMATION_KEYBOARD);TB_MANAGE_PLAYERS.title=i18n("Manage players");TB_MANAGE_PLAYERS.shortcut=
shortcutStr(LMS_MANAGEPLAYERS_KEYBOARD);TB_MINI_PLAYER.title=i18n("Open mini-player");this.menuItems=[TB_UI_SETTINGS,TB_PLAYER_SETTINGS,TB_INFO];this.desktop&&!this.mini&!IS_MOBILE&&(this.menuItems.push(DIVIDER),this.menuItems.push(TB_MINI_PLAYER));this.trans={noplayer:i18n("No Player"),nothingplaying:i18n("Nothing playing"),synchronise:i18n("Synchronise"),syncShortcut:shortcutStr(LMS_SYNC_KEYBOARD),info:i18n("Show current track information"),infoShortcut:shortcutStr(LMS_TRACK_INFO_KEYBOARD),showLarge:i18n("Expand now playing"),
showLargeShortcut:shortcutStr(LMS_EXPAND_NP_KEYBOARD),hideLarge:i18n("Collapse now playing"),startPlayer:i18n("Start player"),connectionLost:i18n("Server connection lost..."),groupPlayers:"Group Players",standardPlayers:i18n("Standard Players"),pluginUpdatesAvailable:i18n("Plugin updates available")}},setPlayer:function(a){a!=this.$store.state.player.id&&this.$store.commit("setPlayer",a)},menuAction:function(a){TB_UI_SETTINGS.id==a?bus.$emit("dlg.open","uisettings"):TB_PLAYER_SETTINGS.id==a?bus.$emit("dlg.open",
"playersettings"):TB_INFO.id==a?bus.$emit("dlg.open","info"):TB_MANAGE_PLAYERS.id==a?bus.$emit("dlg.open","manage"):TB_MINI_PLAYER.id==a?window.open("mini","MiniPlayer","width=600,height=118,status=no,menubar=no,toolbar=no,location=no"):bus.$emit("toolbarAction",a)},emitInfo:function(){0<this.$store.state.visibleMenus.size||bus.$emit("info")},toggleLargeView:function(a){0<this.$store.state.visibleMenus.size||bus.$emit("largeView",a)},togglePower:function(a,b){lmsCommand(a.id,["power",(this.$store.state.player.id==
a.id?this.playerStatus.ison:a.ison)?"0":"1"]).then(function(b){bus.$emit("refreshStatus",a.id)})},volumeDown:function(a){0<this.$store.state.visibleMenus.size||(a?bus.$emit("playerCommand",["mixer","muting","toggle"]):bus.$emit("playerCommand",["mixer","volume",adjustVolume(Math.abs(this.playerVolume),!1)]))},volumeUp:function(a){0<this.$store.state.visibleMenus.size||(a?bus.$emit("playerCommand",["mixer","muting","toggle"]):bus.$emit("playerCommand",["mixer","volume",adjustVolume(Math.abs(this.playerVolume),
!0)]))},volumeClick:function(a){0<this.$store.state.visibleMenus.size||(a?bus.$emit("playerCommand",["mixer","muting","toggle"]):this.playerMuted?bus.$emit("playerCommand",["mixer","muting",0]):bus.$emit("dlg.open","volume"))},setVolume:function(){bus.$emit("playerCommand",["mixer","volume",this.playerVolume])},toggleMute:function(){bus.$emit("playerCommand",["mixer","muting","toggle"])},playPauseButton:function(a){0<this.$store.state.visibleMenus.size||(a?bus.$emit("dlg.open","sleep",this.$store.state.player):
bus.$emit("playerCommand",[this.playerStatus.isplaying?"pause":"play"]))},showSleep:function(){0<this.$store.state.visibleMenus.size||bus.$emit("dlg.open","sleep",this.$store.state.player)},cancelSleepTimer:function(){this.playerStatus.sleepTime=void 0;void 0!==this.playerStatus.sleepTimer&&(clearInterval(this.playerStatus.sleepTimer),this.playerStatus.sleepTimer=void 0)},controlSleepTimer:function(a){void 0!=a&&1<a?(a=Math.floor(a),this.playerStatus.sleepTimeLeft!=a&&(this.cancelSleepTimer(),this.playerStatus.sleepTime=
a,this.playerStatus.sleepTimeLeft=this.playerStatus.sleepTime,this.playerStatus.sleepStart=new Date,this.playerStatus.sleepTimer=setInterval(function(){var a=((new Date).getTime()-this.playerStatus.sleepStart.getTime())/1E3;this.playerStatus.sleepTime=this.playerStatus.sleepTimeLeft-a;0>=this.playerStatus.sleepTime&&(this.playerStatus.sleepTime=void 0,this.cancelSleepTimer())}.bind(this),1E3))):this.cancelSleepTimer()},cancelDisconnectedTimer:function(){void 0!==this.disconnectedTimer&&(clearInterval(this.disconnectedTimer),
this.disconnectedTimer=void 0)},movePlayer:function(a){this.$confirm(i18n("Move '%1' from '%2' to this server?",a.name,a.server),{buttonTrueText:i18n("Move"),buttonFalseText:i18n("Cancel")}).then(function(b){b&&bus.$emit("movePlayer",a)})},volumeSliderStart:function(){this.movingVolumeSlider=!0},volumeSliderEnd:function(){var a=this;this.$store.state.player?lmsCommand(this.$store.state.player.id,["mixer","volume",this.playerVolume]).then(function(b){bus.$emit("updatePlayer",a.$store.state.player.id);
a.movingVolumeSlider=!1}).catch(function(b){bus.$emit("updatePlayer",a.$store.state.player.id);a.movingVolumeSlider=!1}):this.movingVolumeSlider=!1;this.cancelSendVolumeTimer()},cancelSendVolumeTimer:function(){void 0!==this.sendVolumeTimer&&(clearTimeout(this.sendVolumeTimer),this.sendVolumeTimer=void 0)},resetSendVolumeTimer:function(){this.cancelSendVolumeTimer();this.sendVolumeTimer=setTimeout(function(){bus.$emit("playerCommand",["mixer","volume",this.playerVolume])}.bind(this),LMS_VOLUME_DEBOUNCE)}},
computed:{player:function(){return this.$store.state.player},players:function(){return this.$store.state.players},otherPlayers:function(){return this.$store.state.otherPlayers},multipleStandardPlayers:function(){return this.$store.state.players&&1<this.$store.state.players.length&&!this.$store.state.players[1].isgroup},infoPlugin:function(){return this.$store.state.infoPlugin},showPlayerMenuEntry:function(){return isAndroid()&&this.$store.state.showPlayerMenuEntry},isNowPlayingPage:function(){return"now-playing"==
this.$store.state.page},currentPage:function(){return this.$store.state.page},noPlayer:function(){return!this.$store.state.players||1>this.$store.state.players.length},darkUi:function(){return this.$store.state.darkUi},menuIcons:function(){return this.$store.state.menuIcons},menuVisible:function(){return 0<this.$store.state.visibleMenus.size},pluginUpdatesAvailable:function(){return this.$store.state.pluginUpdatesAvailable},keyboardControl:function(){return this.$store.state.keyboardControl&&!IS_MOBILE}},
filters:{displayTime:function(a){return void 0==a?"":formatSeconds(Math.floor(a))},displayVolume:function(a){return void 0==a?"":0>a?-1*a:a},svgIcon:function(a,b,c){return"/material/svg/"+a+"?c="+(c?LMS_UPDATE_SVG:b?LMS_DARK_SVG:LMS_LIGHT_SVG)+"&r="+LMS_MATERIAL_REVISION},tooltip:function(a,b,c){return c?a+SEPARATOR+b:a},playerShortcut:function(a){return i18n("Alt+%1",9==a?0:a+1)}},watch:{playerVolume:function(a){0<=a&&this.resetSendVolumeTimer()},showPlayerMenu:function(a){this.$store.commit("menuVisible",
{name:"player",shown:a});a&&bus.$emit("refreshServerStatus")},showMainMenu:function(a){this.$store.commit("menuVisible",{name:"main",shown:a})}},beforeDestroy:function(){this.cancelSleepTimer();this.cancelDisconnectedTimer()}});
